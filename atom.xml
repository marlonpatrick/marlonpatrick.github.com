<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Marlon Patrick</title>
  <subtitle>Dicas de um programador</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://marlonpatrick.info/"/>
  <updated>2015-08-02T12:59:57.000Z</updated>
  <id>http://marlonpatrick.info/</id>
  
  <author>
    <name>Marlon Patrick</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="http://marlonpatrick.info/undefined/2015/12/06/hello-world/"/>
    <id>http://marlonpatrick.info/undefined/2015/12/06/hello-world/</id>
    <published>2015-12-06T16:21:41.348Z</published>
    <updated>2015-08-02T12:59:57.000Z</updated>
    
    <content type="html">&lt;p&gt;Welcome to &lt;a href=&quot;http://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;http://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;http://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;Quick_Start&quot;&gt;&lt;a href=&quot;#Quick_Start&quot; class=&quot;headerlink&quot; title=&quot;Quick Start&quot;&gt;&lt;/a&gt;Quick Start&lt;/h2&gt;&lt;h3 id=&quot;Create_a_new_post&quot;&gt;&lt;a href=&quot;#Create_a_new_post&quot; class=&quot;headerlink&quot; title=&quot;Create a new post&quot;&gt;&lt;/a&gt;Create a new post&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo new &lt;span class=&quot;string&quot;&gt;&quot;My New Post&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;http://hexo.io/docs/writing.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Writing&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Run_server&quot;&gt;&lt;a href=&quot;#Run_server&quot; class=&quot;headerlink&quot; title=&quot;Run server&quot;&gt;&lt;/a&gt;Run server&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo server&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;http://hexo.io/docs/server.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Server&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Generate_static_files&quot;&gt;&lt;a href=&quot;#Generate_static_files&quot; class=&quot;headerlink&quot; title=&quot;Generate static files&quot;&gt;&lt;/a&gt;Generate static files&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo generate&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;http://hexo.io/docs/generating.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Generating&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Deploy_to_remote_sites&quot;&gt;&lt;a href=&quot;#Deploy_to_remote_sites&quot; class=&quot;headerlink&quot; title=&quot;Deploy to remote sites&quot;&gt;&lt;/a&gt;Deploy to remote sites&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo deploy&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;http://hexo.io/docs/deployment.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Deployment&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;http://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;http://hexo.io
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>One-Click Deployment in JBoss with Jenkins and Maven</title>
    <link href="http://marlonpatrick.info/en/2015/08/08/One-Click-Deployment-in-JBoss-with-Jenkins-and-Maven/"/>
    <id>http://marlonpatrick.info/en/2015/08/08/One-Click-Deployment-in-JBoss-with-Jenkins-and-Maven/</id>
    <published>2015-08-08T19:08:20.000Z</published>
    <updated>2015-09-13T16:01:11.000Z</updated>
    
    <content type="html">&lt;p&gt;Recently, I automate the build of an application that runs in JBoss EAP 6.3 and uses Maven to project management. In general terms, the automated process was:&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;Create tag in SVN&lt;/li&gt;
&lt;li&gt;Download tag and generate a war file&lt;/li&gt;
&lt;li&gt;Send war file to JBoss&lt;/li&gt;
&lt;li&gt;Deactivate current war file in JBoss&lt;/li&gt;
&lt;li&gt;Run scripts in database (PostgreSQL)&lt;/li&gt;
&lt;li&gt;Activate new war file in JBoss&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The purpose of this post is describe each of the above topics. I will not show how to install Jenkins or JBoss, I will only present settings I used to automate the build of this application. The process and tools adopted here are only a first step, many improvements can be made, so fits things to meet your project requirements.&lt;/p&gt;
&lt;p&gt;The project structure is as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Main aggregator project&lt;/li&gt;
&lt;li&gt;EJB project (jar)&lt;/li&gt;
&lt;li&gt;Web project(war)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;1-project-structure.png&quot; alt=&quot;1&quot; title=&quot;Project structure&quot;&gt;&lt;/p&gt;
&lt;p&gt;During the post OCDT is short for the project name in Eclipse (One Click Deploy Test).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1 - Create tag in SVN&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In this project the development occurs always in a branch and for each released version is created a tag in SVN, this way, the code used in the version is easily recovered if necessary. For achieve this objective I used the &lt;a href=&quot;http://maven.apache.org/maven-release/maven-release-plugin/&quot; title=&quot;[external]&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;maven-release-plugin&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The first step is add in your main pom the scm tag. The maven-release-plugin will use scm.developerConnection for downloading the source code and for creating a new tag in SVN. In my case, the URL points to a branch and the branch name is parametrized through parameter SVN_BRANCH (the name of this parameter can be anyone). The parameter SVN_BRANCH will be informed in the Jenkins build page.&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;scm&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;developerConnection&lt;/span&gt;&amp;gt;&lt;/span&gt;scm:svn:http://yoursvnurl/your-project-name/branches/$&amp;#123;SVN_BRANCH&amp;#125;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;developerConnection&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;scm&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The second step is add and setting the maven-release-plugin in your main pom:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;pluginManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-release-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.5.2&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;tagNameFormat&lt;/span&gt;&amp;gt;&lt;/span&gt;v@&amp;#123;project.version&amp;#125;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;tagNameFormat&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;providerImplementations&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;svn&lt;/span&gt;&amp;gt;&lt;/span&gt;javasvn&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;svn&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;providerImplementations&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.google.code.maven-scm-provider-svnjava&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-scm-provider-svnjava&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.1.1&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;pluginManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The tagNameFormat defines the name of the tag that will be created, for example, whether version is 1.0.0-SNAPSHOT the tag name will be v1.0.0. With maven-scm-provider-svnjava is not necessary to install a svn in the OS because this plugin is a svn-client and the maven-relase-plugin will use it for connecting with SVN.&lt;/p&gt;
&lt;p&gt;Now go in Manage Jenkins &amp;gt; Manage Plugins and install “Parameterized Trigger plugin”, this plugin allow us trigger a new job after complete the build and this will be helpful.&lt;/p&gt;
&lt;p&gt;The next step is to create a job in Jenkins of type “Maven project” that will use the maven-release-plugin, the name I gave this job was OCDT_TAG_AND_DEPLOY. In Job Configuration page some options are important:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check “This build is parameterized”;&lt;/li&gt;
&lt;li&gt;Add a parameter “List Subversion tags (and more)” called SVN_BRANCH. In Repository URL put something like this: http ://yoursvnurl/your-project-name/branches and inform a user/password in “Credentials” option. This Jenkins parameter will replace the maven parameter in scm.developerConnection;&lt;/li&gt;
&lt;li&gt;In Source Code Management check Subversion. In Repository URL put something like http ://yoursvnurl/your-project-name/branches/${SVN_BRANCH}, after enter a user/password for SVN, in Local module directory put ${SVN_BRANCH} and in Check-out Strategy choice “Use ‘svn update’ as much as possible, with ‘svn revert’ before update”;&lt;/li&gt;
&lt;li&gt;In Build &amp;gt; Goals and options enter “release:clean release:prepare -DSVN_BRANCH=${SVN_BRANCH} -Dusername=your_svn_user -Dpassword=your_svn_password”. Here, the SVN credentials are in the clear format, this is not a security way for supplier credentials to the Jenkins, but, for simplifying this post I used this format;&lt;/li&gt;
&lt;li&gt;In Post-build Actions choice “Trigger parameterized build on other projects”. In Projects to Build enter OCDT_DEPLOY (name of the our next job), after in Add Parameters option select “Parameters from properties files” and put ${SVN_BRANCH}/release.properties in field Use properties from file and check option “Don’t trigger if any files are missing”. Still in Add Parameters select too “Current build parameters”. This configuration will run the job OCDT_DEPLOY after this job and will pass your own parameters and all properties in release.properties file (generated by maven-release-plugin) as parameters for OCDT_DEPLOY.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At this point, the jobs are capable of downloading source code in SVN and then generate a tag. &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;2-build-page-tag-deploy.png&quot; alt=&quot;2&quot; title=&quot;Jenkins Build Page&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2 - Download tag and generate a war file&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After the tag be created, the next step is to download her and then build a war file for deploy in JBoss, for this, we will create new job in Jenkins called OCDT_DEPLOY of type “Maven project”. The job configurations are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check “This build is parameterized”;&lt;/li&gt;
&lt;li&gt;Add a parameter “List Subversion tags (and more)” called scm.tag. In Repository URL put something like this: http ://yoursvnurl/your-project-name/tags and inform a user/password in “Credentials” option. This parameter will be used for parametrizing the SVN URL.&lt;/li&gt;
&lt;li&gt;In Source Code Management check Subversion. In Repository URL put something like http ://yoursvnurl/your-project-name/tags/${scm.tag}, after enter a user/password for SVN, in Local module directory put ${scm.tag} and in Check-out Strategy choice “Use ‘svn update’ as much as possible, with ‘svn revert’ before update”;&lt;/li&gt;
&lt;li&gt;In Build &amp;gt; Goals and options enter “clean package”.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The idea is that the job OCDT_TAG_AND_DEPLOY will generate a tag and pass the tag name for the job OCDT_DEPLOY which will generate a war file based on source code of the tag. The tag name is passed through the release.properties file that contain a property called scm.tag and that points to the tag created by the maven-release-plugin. If you already have a tag, then don’t need execute OCDT_TAG_AND_DEPLOY only executes OCDT_DEPLOY supplying the tag name manually.&lt;/p&gt;
&lt;p&gt;At this moment, the web-module/pom.xml has a build setting like this:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;web-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;finalName&lt;/span&gt;&amp;gt;&lt;/span&gt;ocdt-$&amp;#123;project.version&amp;#125;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;finalName&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-war-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.6&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;failOnMissingWebXml&lt;/span&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;failOnMissingWebXml&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.mpwtecnologia&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;ejb-module&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0.0-SNAPSHOT&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;And the ejb-module/pom.xml has a build setting like this:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;ejb-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-ejb-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.5&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;ejbVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;3.1&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;ejbVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;3 - Send war file to JBoss&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If you running the job OCDT_DEPLOY he will generate a war file, but will not do anything with it. For deploy the war file in JBoss some others configurations are needed. Let’s go!&lt;/p&gt;
&lt;p&gt;The first thing to do is add the &lt;a href=&quot;https://docs.jboss.org/jbossas/7/plugins/maven/latest/index.html&quot; title=&quot;[external]&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jboss-as-maven-plugin &lt;/a&gt; in the project. This plugin has various goals to executes many tasks in a JBoss Server as deploy, start, shutdown among others.&lt;/p&gt;
&lt;p&gt;Open main pom.xml and add jboss-as-maven-plugin:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;pluginManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		      &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Previous settings here --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.jboss.as.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;jboss-as-maven-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;7.7.Final&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;timeout&lt;/span&gt;&amp;gt;&lt;/span&gt;60000&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;timeout&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;username&lt;/span&gt;&amp;gt;&lt;/span&gt;your-jboss-admin-user&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;username&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;your-jboss-admin-password&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;hostname&lt;/span&gt;&amp;gt;&lt;/span&gt;192.168.25.2&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;hostname&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- put your IP or hostname --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;pluginManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;jboss-as.skip&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;jboss-as.skip&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;For test purposes this setting is ok, but in a production environment is not a good idea have user/password in clear text.&lt;/p&gt;
&lt;p&gt;The flag jboss-as.skip is setting for true by default to prevent a deploy in job OCDT_TAG_AND_DEPLOY, this way only in job OCDT_DEPLOY is sent a deploy to JBoss.&lt;/p&gt;
&lt;p&gt;In web-module/pom.xml setting jboss-as-maven-plugin:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;web-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Previous settings here --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.jboss.as.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;jboss-as-maven-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;upload-war&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;post-integration-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;deploy&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;deployEnabled&lt;/span&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;deployEnabled&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;force&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;force&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;domain&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- This configuration is need only if you running JBoss in domain mode --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;server-groups&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;								&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;server-group&lt;/span&gt;&amp;gt;&lt;/span&gt;my-domain-group&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;server-group&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;server-groups&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;domain&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Execution unassign-war should be used only if you running JBoss in domain mode --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;unassign-war&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;post-integration-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;execute-commands&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;executeCommands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;batch&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;batch&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;commands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;								&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;command&lt;/span&gt;&amp;gt;&lt;/span&gt;undeploy $&amp;#123;project.build.finalName&amp;#125;.$&amp;#123;project.packaging&amp;#125; --keep-content --server-groups=my-domain-group&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;command&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;commands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;executeCommands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;In OCDT_DEPLOY job change the Build &amp;gt; Goals to “clean package post-integration-test -Djboss-as.skip=false”.&lt;/p&gt;
&lt;p&gt;This configuration creates a maven execution called upload-war that sends the war file to JBoss without enabling it or disable any other active deploy, this task will be executed in post-integration-test phase. Observe that the execution unassign-war is only needed for domain mode, this is needed because in the next steps we will run another deploy command for activating this war file and if it is assigned to a server-group an error will occur.&lt;/p&gt;
&lt;p&gt;At this moment the Jenkins Server will try connect in JBoss Server and some problems can happen, for prevent this, you should guarantee that Jenkins can connect in JBoss through the port 9999, a simple telnet can test this.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4 - Deactivate current war file in JBoss&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now that we have already sent the war file to JBoss the next step is deactivate the current deploy, for this we will add a parameter called ACTIVE_DEPLOY in the two jobs previously created in Jenkins. Go in OCDT_TAG_AND_DEPLOY &amp;gt; Configure &amp;gt; This build is parameterized &amp;gt; Add Parameter and choice “String Parameter”, in Name field put ACTIVE_DEPLOY. Repeat this for OCDT_DEPLOY.&lt;/p&gt;
&lt;p&gt;Still in OCDT_DEPLOY change the Build &amp;gt; Goals to “clean package post-integration-test -Djboss-as.skip=false -DACTIVE_DEPLOY=${ACTIVE_DEPLOY}”.&lt;/p&gt;
&lt;p&gt;After, creates a new execution for jboss-as-maven-plugin in web-module/pom.xml called deactivate-running-deploy:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;web-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;deactivate-running-deploy&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;post-integration-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;execute-commands&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;executeCommands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;batch&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;batch&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;commands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		  &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- The parameter server-groups is necessary only if you running JBoss in domain mode --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;command&lt;/span&gt;&amp;gt;&lt;/span&gt;undeploy $&amp;#123;ACTIVE_DEPLOY&amp;#125; --keep-content --server-groups=my-domain-group&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;command&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;commands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;executeCommands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;5 - Run scripts in database&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After sent war file to JBoss and disable the current deploy the next step is running some scripts in the database before active new deploy. &lt;/p&gt;
&lt;p&gt;We will use &lt;a href=&quot;http://flywaydb.org/documentation/maven/&quot; title=&quot;[external]&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;flyway-maven-plugin&lt;/a&gt; for this task. Flyway is a tool for database version control and has many features to facilitates this work including SQL or Java migrations.&lt;/p&gt;
&lt;p&gt;Add flyway-maven-plugin in managed plugins section in the main pom.xml:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;pluginManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		      &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Previous settings here --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.flywaydb&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;flyway-maven-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.2.1&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;skip&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;skip&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;jdbc:postgresql://192.168.25.3:5432/ocdt&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;user&lt;/span&gt;&amp;gt;&lt;/span&gt;your-database-user&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;user&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;your-database-password&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;validateOnMigrate&lt;/span&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;validateOnMigrate&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;baselineOnMigrate&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;baselineOnMigrate&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;schemas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;schema&lt;/span&gt;&amp;gt;&lt;/span&gt;ocdt&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;schema&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;schemas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;pluginManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;In web-module/pom.xml setting flyway-maven-plugin:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;web-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Previous settings here --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.flywaydb&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;flyway-maven-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;update-database&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;post-integration-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;migrate&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;In my case, the database is Postgres then I add a dependency to the Postgres driver in ejb-module/pom.xml (could be any pom.xml):&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;ejb-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.postgresql&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;postgresql&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;9.3-1101-jdbc41&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now, in OCDT_DEPLOY change the Build &amp;gt; Goals to “clean package post-integration-test -Djboss-as.skip=false -Dflyway.skip=false -DACTIVE_DEPLOY=${ACTIVE_DEPLOY}”.&lt;/p&gt;
&lt;p&gt;Create a file in src/main/resources/db/migration folder with name V01.00.00__Populate_Database.sql and put some SQL to change the database. For understand more about how Flyway search scripts and manages versions see &lt;a href=&quot;http://flywaydb.org/documentation/migration/&quot; title=&quot;[external]&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;documentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;6 - Activate new war file in JBoss&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;To finalize, now that the database is compliance with the new war file then we can activate it, for this only is necessary create more one execution in web-module/pom.xml:&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;figcaption&gt;&lt;span&gt;web-module/pom.xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- upload-war --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- deactivate-running-deploy --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- update-database --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.jboss.as.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;jboss-as-maven-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;enable-this-war&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;post-integration-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;execute-commands&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;executeCommands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;batch&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;batch&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;commands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;								&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- The parameter server-groups is necessary only if you running JBoss in domain mode --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;								&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;command&lt;/span&gt;&amp;gt;&lt;/span&gt;deploy --name=$&amp;#123;project.build.finalName&amp;#125;.$&amp;#123;project.packaging&amp;#125; --server-groups=my-domain-group&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;command&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;							&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;commands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;						&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;executeCommands&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;					&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The end! With steps above you will be capable of automating the build of your project with only one click. The complete code of the example is available in my &lt;a href=&quot;https://github.com/marlonpatrick10/one-click-deployment-jboss-jenkins-maven&quot; title=&quot;[external]&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Recently, I automate the build of an application that runs in JBoss EAP 6.3 and uses Maven to project management. In general terms, the automated process was:&lt;/p&gt;
    
    </summary>
    
      <category term="Jenkins" scheme="http://marlonpatrick.info/categories/Jenkins/"/>
    
      <category term="JBoss" scheme="http://marlonpatrick.info/categories/Jenkins/JBoss/"/>
    
      <category term="Maven" scheme="http://marlonpatrick.info/categories/Jenkins/JBoss/Maven/"/>
    
    
      <category term="Flyway" scheme="http://marlonpatrick.info/tags/Flyway/"/>
    
      <category term="JBoss" scheme="http://marlonpatrick.info/tags/JBoss/"/>
    
      <category term="Jenkins" scheme="http://marlonpatrick.info/tags/Jenkins/"/>
    
      <category term="Maven" scheme="http://marlonpatrick.info/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>JBOSS: SQL log in a simple way with jdbcdslog</title>
    <link href="http://marlonpatrick.info/en/2014/12/14/jboss-sql-log-in-simple-way-with-jdbcdslog/"/>
    <id>http://marlonpatrick.info/en/2014/12/14/jboss-sql-log-in-simple-way-with-jdbcdslog/</id>
    <published>2014-12-14T20:36:00.000Z</published>
    <updated>2015-08-03T01:43:09.000Z</updated>
    
    <content type="html">&lt;p&gt;A basic necessity in almost every software project is the log of SQL statements and for this purpose there is a plethora of options. However, despite the many alternatives, the log is often not made the best way:&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;Excessive log: too much is logged (queries, opening and closing connections, opening and closing resultsets) and the programmer does not have the possibility to configure what should or should not be logged.&lt;/li&gt;
&lt;li&gt;Lack of integration with logging frameworks: the lib caters well to the SQL Log requirements, however, does not integrate with logging frameworks (log4j, java logging, apache commons logging) which ultimately forcing the developer to create a specific log file to SQL.&lt;/li&gt;
&lt;li&gt;Problems to work with DataSources, in particular XA-DataSources: a well logging tool meets the above two requirements, however, is limited to use with java.sql.Connection objects, or in other cases may be used with “normal” DataSources, however, do not meet when we need to log sql XA-DataSource.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For those who use Hibernate first choice is usually set it to log the generated queries, the result is something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select this_.code from employee this_ where this_.code=?
INSERT INTO stock_transaction (CHANGE, CLOSE, DATE, OPEN, STOCK_ID, VOLUME) VALUES (?, ?, ?, ?, ?, ?)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this case we have two problems, the first is that the values of the filters and columns are not logged in, only the character &lt;strong&gt;?&lt;/strong&gt; is shown indicating that was replaced by a parameter. The other problem is that queries are not always carried out by Hibernate, in such cases the log would not be displayed, not even the log without parameters.&lt;/p&gt;
&lt;p&gt;Well, after testing some sql log libs found one that met me in all these aspects: control of what is logged, integration with the most popular logging frameworks, work with Connection, DataSource and XA-DataSource, log sql with all its parameters so that I can copy and paste in the database access tool and run the script, and finally, log any sql that be through the monitored connection is made by Hibernate or otherwise. The lib name is &lt;a href=&quot;https://code.google.com/p/jdbcdslog/&quot; title=&quot;jdbcdslog&quot; target=&quot;_blank&quot;&gt;jdbcdslog&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The most basic example is logging the queries of a single Connection object:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args) throws Exception {
    Class.forName(&amp;quot;org.jdbcdslog.DriverLoggingProxy&amp;quot;);

    String url = &amp;quot;jdbc:jdbcdslog:postgresql://172.16.1.6:5432/mpinfo;targetDriver=org.postgresql.Driver&amp;quot;;
    Connection con = DriverManager.getConnection(url, &amp;quot;mpinfo&amp;quot;, &amp;quot;mpinfo&amp;quot;);

    PreparedStatement ps = con.prepareStatement(&amp;quot;select * from product where id=?&amp;quot;);
    ps.setLong(1, 1);
    ps.execute();

    con.close();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this example I am accessing a PostgreSQL database and notice that the URL is a little different from the norm because jdbcdslog must add the driver as a proxy for the original driver Postgres. You can see this in &lt;strong&gt;jdbc:jdbcdslog:postgresql&lt;/strong&gt; and also in &lt;strong&gt;targetDriver&lt;/strong&gt; parameter. The result of this code is something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[main] INFO org.jdbcdslog.StatementLogger - select * from ceos.product where id=1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;But what I want to demonstrate even here in this post is how to use this lib to log sql datasources in JBoss, here in my enviroment I will use the JBoss EAP 6.2, but I think from the version of JBoss 7 does not change almost nothing. To do this we create modules to JBoss with the Postgres driver and also jdbcdslog.&lt;/p&gt;
&lt;p&gt;1 - First we must create the folder JBOSS_HOME/modules/system/layers/base/org/postgresql/main/. Inside that folder put the Postgres jar according to the version you use, for example, postgresql-9.3-1101-jdbc41.jar. In addition we must create a file called module.xml with the following content:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;module xmlns=&amp;quot;urn:jboss:module:1.1&amp;quot; name=&amp;quot;org.postgresql&amp;quot;&amp;gt;
    &amp;lt;resources&amp;gt;
        &amp;lt;resource-root path=&amp;quot;postgresql-9.3-1101-jdbc41.jar&amp;quot;/&amp;gt;
    &amp;lt;/resources&amp;gt;
    &amp;lt;dependencies&amp;gt;
        &amp;lt;module name=&amp;quot;javax.api&amp;quot;/&amp;gt;
        &amp;lt;module name=&amp;quot;javax.transaction.api&amp;quot;/&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/module&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This procedure should be done for any database you want to log the queries, either Postgres, Oracle, MySQL etc. The logic is the same, just pay attention to the names of the files and folder which will be placed. The suggestion is to use the name of the main jar package in the case of Postgres is org.postgresql.&lt;/p&gt;
&lt;p&gt;2 - Now is the time to create the jdbcdslog module. For this we create the folder JBOSS_HOME/modules/system/layers/base/com/googlecode/usc/jdbcdslog/main/. In this folder we will put the jdbcdslog jar, for example, jdbcdslog-1.0.6.2.jar. We also need to create a file called module.xml with the following content:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;module xmlns=&amp;quot;urn:jboss:module:1.1&amp;quot; name=&amp;quot;com.googlecode.usc.jdbcdslog&amp;quot;&amp;gt;
    &amp;lt;resources&amp;gt;
        &amp;lt;resource-root path=&amp;quot;jdbcdslog-1.0.6.2.jar&amp;quot;/&amp;gt;
    &amp;lt;/resources&amp;gt;
    &amp;lt;dependencies&amp;gt;
        &amp;lt;module name=&amp;quot;org.slf4j&amp;quot;/&amp;gt;
        &amp;lt;module name=&amp;quot;javax.api&amp;quot;/&amp;gt;
        &amp;lt;module name=&amp;quot;javax.transaction.api&amp;quot;/&amp;gt;
    &amp;lt;module name=&amp;quot;org.postgresql&amp;quot; optional=&amp;quot;true&amp;quot;/&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/module&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note that the Postgres module dependency is optional. It must include modules from other databases (Oracle, MySQL) as module dependency of jdbcdslog if you want to log them as well.&lt;/p&gt;
&lt;p&gt;3 - Now open the file JBOSS_HOME/standalone/configuration/standalone.xml and configure the jdbcdslog logs. Look for the log subsystem tag, something like &lt;code&gt;&amp;lt;subsystem xmlns=&amp;quot;urn:jboss:domain:logging:1.3&amp;quot;&amp;gt;&lt;/code&gt; within this tag place the following contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;logger category=&amp;quot;org.jdbcdslog.StatementLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;DEBUG&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&amp;lt;logger category=&amp;quot;org.jdbcdslog.ConnectionLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;OFF&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&amp;lt;logger category=&amp;quot;org.jdbcdslog.ResultSetLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;OFF&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&amp;lt;logger category=&amp;quot;org.jdbcdslog.SlowQueryLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;OFF&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The various logging options available, the only one left active was the log statements, ie DML and DDL commands log.&lt;/p&gt;
&lt;p&gt;NOTE: If your JBoss is running in domain mode rather than standalone then this setting can be made to the file JBOSS_HOME/domain/configuration/domain.xml.&lt;/p&gt;
&lt;p&gt;4 - Still in standalone.xml file we will create the datasource. Below are two examples, one for a normal datasource and one for an XA-DataSoure, both should stay within the &lt;code&gt;&amp;lt;datasources&amp;gt;&lt;/code&gt; tag:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;datasource jta=&amp;quot;true&amp;quot; jndi-name=&amp;quot;java:/mpinfods&amp;quot; pool-name=&amp;quot;MPINFO-POOL&amp;quot; enabled=&amp;quot;true&amp;quot; use-ccm=&amp;quot;true&amp;quot;&amp;gt;
    &amp;lt;connection-url&amp;gt;jdbc:jdbcdslog:postgresql://172.16.1.6:5432/mpinfo;targetDriver=org.postgresql.Driver&amp;lt;/connection-url&amp;gt;
    &amp;lt;driver&amp;gt;jdbcdslog&amp;lt;/driver&amp;gt;
    &amp;lt;new-connection-sql&amp;gt;select 1&amp;lt;/new-connection-sql&amp;gt;
    &amp;lt;transaction-isolation&amp;gt;TRANSACTION_READ_COMMITTED&amp;lt;/transaction-isolation&amp;gt;
    &amp;lt;pool&amp;gt;
    &amp;lt;min-pool-size&amp;gt;10&amp;lt;/min-pool-size&amp;gt;
    &amp;lt;max-pool-size&amp;gt;20&amp;lt;/max-pool-size&amp;gt;
    &amp;lt;/pool&amp;gt;
    &amp;lt;security&amp;gt;
    &amp;lt;user-name&amp;gt;mpinfo&amp;lt;/user-name&amp;gt;
    &amp;lt;password&amp;gt;mpinfo&amp;lt;/password&amp;gt;
    &amp;lt;/security&amp;gt;
    &amp;lt;validation&amp;gt;
    &amp;lt;validate-on-match&amp;gt;false&amp;lt;/validate-on-match&amp;gt;
    &amp;lt;background-validation&amp;gt;false&amp;lt;/background-validation&amp;gt;
    &amp;lt;background-validation-millis&amp;gt;1&amp;lt;/background-validation-millis&amp;gt;
    &amp;lt;/validation&amp;gt;
    &amp;lt;statement&amp;gt;
    &amp;lt;prepared-statement-cache-size&amp;gt;32&amp;lt;/prepared-statement-cache-size&amp;gt;
    &amp;lt;share-prepared-statements&amp;gt;false&amp;lt;/share-prepared-statements&amp;gt;
    &amp;lt;/statement&amp;gt;
&amp;lt;/datasource&amp;gt;

&amp;lt;xa-datasource jndi-name=&amp;quot;java:/mpinfoxads&amp;quot; pool-name=&amp;quot;MPINFO-XA-POOL&amp;quot; enabled=&amp;quot;true&amp;quot; use-ccm=&amp;quot;true&amp;quot;&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;PortNumber&amp;quot;&amp;gt;5432&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;DatabaseName&amp;quot;&amp;gt;mpinfo&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;ServerName&amp;quot;&amp;gt;172.16.1.6&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;targetDS&amp;quot;&amp;gt;org.postgresql.xa.PGXADataSource&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;driver&amp;gt;jdbcdslog&amp;lt;/driver&amp;gt;
    &amp;lt;new-connection-sql&amp;gt;select 1&amp;lt;/new-connection-sql&amp;gt;
    &amp;lt;transaction-isolation&amp;gt;TRANSACTION_READ_COMMITTED&amp;lt;/transaction-isolation&amp;gt;
    &amp;lt;xa-pool&amp;gt;
        &amp;lt;min-pool-size&amp;gt;0&amp;lt;/min-pool-size&amp;gt;
        &amp;lt;max-pool-size&amp;gt;10&amp;lt;/max-pool-size&amp;gt;
        &amp;lt;flush-strategy&amp;gt;IdleConnections&amp;lt;/flush-strategy&amp;gt;
        &amp;lt;is-same-rm-override&amp;gt;false&amp;lt;/is-same-rm-override&amp;gt;
        &amp;lt;interleaving&amp;gt;false&amp;lt;/interleaving&amp;gt;
        &amp;lt;pad-xid&amp;gt;false&amp;lt;/pad-xid&amp;gt;
        &amp;lt;wrap-xa-resource&amp;gt;false&amp;lt;/wrap-xa-resource&amp;gt;
    &amp;lt;/xa-pool&amp;gt;
    &amp;lt;security&amp;gt;
        &amp;lt;user-name&amp;gt;mpinfo&amp;lt;/user-name&amp;gt;
        &amp;lt;password&amp;gt;mpinfo&amp;lt;/password&amp;gt;
    &amp;lt;/security&amp;gt;
    &amp;lt;validation&amp;gt;
        &amp;lt;valid-connection-checker class-name=&amp;quot;org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLValidConnectionChecker&amp;quot;/&amp;gt;
        &amp;lt;validate-on-match&amp;gt;true&amp;lt;/validate-on-match&amp;gt;
        &amp;lt;background-validation&amp;gt;false&amp;lt;/background-validation&amp;gt;
        &amp;lt;exception-sorter class-name=&amp;quot;org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLExceptionSorter&amp;quot;/&amp;gt;
    &amp;lt;/validation&amp;gt;
    &amp;lt;timeout&amp;gt;
        &amp;lt;idle-timeout-minutes&amp;gt;3&amp;lt;/idle-timeout-minutes&amp;gt;
    &amp;lt;/timeout&amp;gt;
    &amp;lt;statement&amp;gt;
        &amp;lt;track-statements&amp;gt;true&amp;lt;/track-statements&amp;gt;
        &amp;lt;share-prepared-statements&amp;gt;false&amp;lt;/share-prepared-statements&amp;gt;
    &amp;lt;/statement&amp;gt;
&amp;lt;/xa-datasource&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;At this point you should pay attention to information as IPs, users, passwords and replace according to your environment, moreover, realize that the tag &lt;code&gt;&amp;lt;driver&amp;gt;&lt;/code&gt; use the jdbcdslog driver name that will define the next step.&lt;/p&gt;
&lt;p&gt;5 - Within the &lt;code&gt;&amp;lt;datasources&amp;gt;&lt;/code&gt; tag (standalone.xml) add a driver setting that makes the log:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;drivers&amp;gt;
    &amp;lt;driver name=&amp;quot;jdbcdslog&amp;quot; module=&amp;quot;com.googlecode.usc.jdbcdslog&amp;quot;&amp;gt;
        &amp;lt;driver-class&amp;gt;org.jdbcdslog.DriverLoggingProxy&amp;lt;/driver-class&amp;gt;
        &amp;lt;xa-datasource-class&amp;gt;org.jdbcdslog.XADataSourceProxy&amp;lt;/xa-datasource-class&amp;gt;
    &amp;lt;/driver&amp;gt;
&amp;lt;/drivers&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There, it can already use the datasource and check the log JBoss any select, update, insert which is done through the connections that datasource will be logged, the output will look like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;11:35:00,066 INFO  [org.jdbcdslog.StatementLogger] (EJB default - 6) select u.password from user u where u.login=&amp;apos;admin&amp;apos;;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you use an XA-DataSource may be confronted with the following error:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Caused by: javax.resource.ResourceException: IJ000453: Unable to get managed connection for java:/MPINFO-XA-Datasource

Caused by: java.lang.LinkageError: loader constraint violation: loader (instance of &amp;lt;bootloader&amp;gt;) previously initiated loading for a different type with name &amp;quot;javax/transaction/xa/XAResource&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The exception is due to a ClassLoader problem in JBoss, the issue is that there are two definitions for javax.transaction.xa.XAResource class: one that is in the standard JVM package and one that is in a jar inside the JBoss. Then, for some reason, JBoss loads the class from your lib and jdbcdslog loads the class from the standard JVM lib (rt.jar) and this is the exception claiming a class with the same name already have been loaded. Well, to solve this adjusted a setting in JBoss to prevent it from load the class that is contained in their own libs and load only the class from the JVM. The procedure is to change the contents of the file JBOSS_HOME/modules/system/layers/base/javax/transaction/api/main/module.xml:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;module xmlns=&amp;quot;urn:jboss:module:1.1&amp;quot; name=&amp;quot;javax.transaction.api&amp;quot;&amp;gt;
    &amp;lt;resources&amp;gt;
        &amp;lt;resource-root path=&amp;quot;jboss-transaction-api_1.1_spec-1.0.1.Final-redhat-2.jar&amp;quot;&amp;gt;
            &amp;lt;filter&amp;gt;
                &amp;lt;exclude path=&amp;quot;javax/transaction/xa&amp;quot;/&amp;gt;
                &amp;lt;include path=&amp;quot;**&amp;quot;/&amp;gt;
            &amp;lt;/filter&amp;gt;
        &amp;lt;/resource-root&amp;gt;
    &amp;lt;/resources&amp;gt;
    &amp;lt;dependencies&amp;gt;
        &amp;lt;system export=&amp;quot;true&amp;quot;&amp;gt;
            &amp;lt;paths&amp;gt;
                &amp;lt;path name=&amp;quot;javax/transaction/xa&amp;quot;/&amp;gt;
            &amp;lt;/paths&amp;gt;
        &amp;lt;/system&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/module&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I recommend that you save the original file before making any change, it probably will not have the tag &lt;code&gt;&amp;lt;dependencies&amp;gt;&lt;/code&gt; and also will not have the tag `&lt;filter&gt; ‘. With this setting finish all necessary settings, now test and verify that the log is generated in accordance with the executed commands.&lt;/filter&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;A basic necessity in almost every software project is the log of SQL statements and for this purpose there is a plethora of options. However, despite the many alternatives, the log is often not made the best way:&lt;/p&gt;
    
    </summary>
    
      <category term="JBOSS" scheme="http://marlonpatrick.info/categories/JBOSS/"/>
    
      <category term="Log" scheme="http://marlonpatrick.info/categories/JBOSS/Log/"/>
    
    
      <category term="Hibernate" scheme="http://marlonpatrick.info/tags/Hibernate/"/>
    
      <category term="JBOSS" scheme="http://marlonpatrick.info/tags/JBOSS/"/>
    
      <category term="JPA" scheme="http://marlonpatrick.info/tags/JPA/"/>
    
      <category term="Log" scheme="http://marlonpatrick.info/tags/Log/"/>
    
      <category term="SQL" scheme="http://marlonpatrick.info/tags/SQL/"/>
    
      <category term="jdbcdslog" scheme="http://marlonpatrick.info/tags/jdbcdslog/"/>
    
  </entry>
  
  <entry>
    <title>JBOSS: Log de SQL de maneira simples com jdbcdslog</title>
    <link href="http://marlonpatrick.info/pt-br/2014/12/14/jboss-log-de-sql-de-maneira-simples-com-jdbcdslog/"/>
    <id>http://marlonpatrick.info/pt-br/2014/12/14/jboss-log-de-sql-de-maneira-simples-com-jdbcdslog/</id>
    <published>2014-12-14T20:36:00.000Z</published>
    <updated>2015-08-03T01:26:20.000Z</updated>
    
    <content type="html">&lt;p&gt;Uma necessidade básica em quase todos os projetos de software é o log de instruções SQL e para esse fim existe uma infinidade de opções. No entanto, apesar das várias alternativas, muitas vezes o log não é feito da melhor forma:&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;Excesso de log: são logadas coisas demais (consultas, abertura e fechamento de conexões, abertura e fechamento de resultsets) e o programador não tem a possibilidade de configurar o que deve ou não ser logado.&lt;/li&gt;
&lt;li&gt;Falta de integração com frameworks de logging: a lib atende bem a os requisitos de Log de SQL, porém, não se integra com frameworks de log (log4j, java logging, apache commons logging) o que acaba obrigando o desenvolvedor a criar um arquivo de log específico para SQL.&lt;/li&gt;
&lt;li&gt;Dificuldades para se trabalhar com DataSources, em especial, XA-DataSources: a ferramenta de log atende bem os dois requisitos acima, porém, é limitada a ser usada com objetos java.sql.Connection, ou em outros casos, podem ser usados com DataSources “normais”, porém, não atendem quando precisamos logar sql de XA-DataSources.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para quem usa o Hibernate a primeira escolha normalmente é configurá-lo para logar as queries geradas, o resultado é algo como:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select this_.code from employee this_ where this_.code=?
INSERT INTO stock_transaction (CHANGE, CLOSE, DATE, OPEN, STOCK_ID, VOLUME) VALUES (?, ?, ?, ?, ?, ?)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nesse caso temos dois problemas, o primeiro é que os valores dos filtros e colunas não são logados, é mostrado apenas o caracter &lt;strong&gt;?&lt;/strong&gt; indicando que foi substituído por um parâmetro. O outro problema é que nem sempre as consultas são realizadas pelo Hibernate, nesses casos, o log não seria mostrado nem mesmo o log sem parâmetros.&lt;/p&gt;
&lt;p&gt;Pois bem, depois de testar algumas libs de log de sql encontrei uma que me atendeu em todos esses aspectos: controle do que será logado, integração com os frameworks de log mais populares, funcionar com Connection, DataSource e XA-Datasource, logar o sql com todos os seus parâmetros de modo que eu possa copiar e colar numa ferramenta de acesso a banco e executar o script, e por fim, logar qualquer sql que se faça através da conexão monitorada seja feita pelo Hibernate ou por qualquer outro modo. O nome da lib é &lt;a href=&quot;https://code.google.com/p/jdbcdslog/&quot; title=&quot;jdbcdslog&quot; target=&quot;_blank&quot;&gt;jdbcdslog&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O exemplo mais básico é logar as queries de um simples objeto Connection:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args) throws Exception {
    Class.forName(&amp;quot;org.jdbcdslog.DriverLoggingProxy&amp;quot;);

    String url = &amp;quot;jdbc:jdbcdslog:postgresql://172.16.1.6:5432/mpinfo;targetDriver=org.postgresql.Driver&amp;quot;;
    Connection con = DriverManager.getConnection(url, &amp;quot;mpinfo&amp;quot;, &amp;quot;mpinfo&amp;quot;);

    PreparedStatement ps = con.prepareStatement(&amp;quot;select * from product where id=?&amp;quot;);
    ps.setLong(1, 1);
    ps.execute();

    con.close();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nesse exemplo estou acessando um banco PostgreSQL e perceba que a URL fica um pouco diferente do padrão pois preciso acrescentar o driver do Jdbcdslog como proxy para o driver original do Postgre. Você pode perceber isso em &lt;strong&gt;jdbc:jdbcdslog:postgresql&lt;/strong&gt; e também no parâmetro &lt;strong&gt;targetDriver&lt;/strong&gt;. O resultado desse código é algo como:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[main] INFO org.jdbcdslog.StatementLogger - select * from ceos.product where id=1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mas o que quero demonstrar mesmo aqui nesse post é como usar essa lib para logar sql de datasources no JBoss, aqui no meu ambiente vou usar o JBoss EAP 6.2, mas acredito que a partir da versão do JBoss 7 não muda quase nada. Para isso vamos criar módulos no JBoss com o driver do Postgre e também do jdbcdslog.&lt;/p&gt;
&lt;p&gt;1 - Primeiro devemos criar a pasta JBOSS_HOME/modules/system/layers/base/org/postgresql/main/. Dentro dessa pasta colocaremos o jar do Postgre de acordo com a versão que você usa, por exemplo, postgresql-9.3-1101-jdbc41.jar. Além disso devemos criar um arquivo chamado module.xml com o seguinte conteúdo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;module xmlns=&amp;quot;urn:jboss:module:1.1&amp;quot; name=&amp;quot;org.postgresql&amp;quot;&amp;gt;
    &amp;lt;resources&amp;gt;
        &amp;lt;resource-root path=&amp;quot;postgresql-9.3-1101-jdbc41.jar&amp;quot;/&amp;gt;
    &amp;lt;/resources&amp;gt;
    &amp;lt;dependencies&amp;gt;
        &amp;lt;module name=&amp;quot;javax.api&amp;quot;/&amp;gt;
        &amp;lt;module name=&amp;quot;javax.transaction.api&amp;quot;/&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/module&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Esse procedimento deverá ser feito para qualquer banco de dados que você queira logar as queries, seja Postgre, Oracle, MySQL etc. A lógica é a mesma, basta prestar atenção nos nomes dos arquivos e na pasta o qual serão colocados. A sugestão é utilizar o nome do pacote principal do jar, no caso do Postgre é o org.postgresql.&lt;/p&gt;
&lt;p&gt;2 - Agora é a vez de criamos o módulo do jdbcdslog. Para isso criamos a pasta JBOSS_HOME/modules/system/layers/base/com/googlecode/usc/jdbcdslog/main/. Nessa pasta iremos colocar o jar do jdbcdslog, por exemplo, jdbcdslog-1.0.6.2.jar. Também precisaremos criar um arquivo chamado module.xml com o seguinte conteúdo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;module xmlns=&amp;quot;urn:jboss:module:1.1&amp;quot; name=&amp;quot;com.googlecode.usc.jdbcdslog&amp;quot;&amp;gt;
    &amp;lt;resources&amp;gt;
        &amp;lt;resource-root path=&amp;quot;jdbcdslog-1.0.6.2.jar&amp;quot;/&amp;gt;
    &amp;lt;/resources&amp;gt;
    &amp;lt;dependencies&amp;gt;
        &amp;lt;module name=&amp;quot;org.slf4j&amp;quot;/&amp;gt;
        &amp;lt;module name=&amp;quot;javax.api&amp;quot;/&amp;gt;
        &amp;lt;module name=&amp;quot;javax.transaction.api&amp;quot;/&amp;gt;
    &amp;lt;module name=&amp;quot;org.postgresql&amp;quot; optional=&amp;quot;true&amp;quot;/&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/module&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Perceba que a dependência do módulo do Postgre é opcional. Será necessário incluir os módulos de outros bancos de dados (Oracle, Mysql) como dependência do módulo do jdbcdslog caso você queira fazer o log deles também.&lt;/p&gt;
&lt;p&gt;3 - Agora abra o arquivo JBOSS_HOME/standalone/configuration/standalone.xml e configure os logs do jdbcdslog. Procure a tag do subsistema de log, algo como &lt;code&gt;&amp;lt;subsystem xmlns=&amp;quot;urn:jboss:domain:logging:1.3&amp;quot;&amp;gt;&lt;/code&gt;, dentro dessa tag coloque o seguinte conteúdo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;logger category=&amp;quot;org.jdbcdslog.StatementLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;DEBUG&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&amp;lt;logger category=&amp;quot;org.jdbcdslog.ConnectionLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;OFF&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&amp;lt;logger category=&amp;quot;org.jdbcdslog.ResultSetLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;OFF&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&amp;lt;logger category=&amp;quot;org.jdbcdslog.SlowQueryLogger&amp;quot;&amp;gt;
    &amp;lt;level name=&amp;quot;OFF&amp;quot;/&amp;gt;
&amp;lt;/logger&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Das várias opções de log disponíveis, a única que deixamos ativa foi o log de statements, ou seja, log de comandos DML e DDL.&lt;/p&gt;
&lt;p&gt;OBS:Caso seu JBoss esteja executando em modo domínio ao invés de standalone então essa configuração pode ser feita no arquivo JBOSS_HOME/domain/configuration/domain.xml&lt;/p&gt;
&lt;p&gt;4 - Ainda no arquivo standalone.xml vamos criar o datasource. Abaixo seguem dois exemplos, um para um datasource normal e outro para um XA-DataSoure, ambos devem ficar dentro da tag &lt;code&gt;&amp;lt;datasources&amp;gt;&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;datasource jta=&amp;quot;true&amp;quot; jndi-name=&amp;quot;java:/mpinfods&amp;quot; pool-name=&amp;quot;MPINFO-POOL&amp;quot; enabled=&amp;quot;true&amp;quot; use-ccm=&amp;quot;true&amp;quot;&amp;gt;
    &amp;lt;connection-url&amp;gt;jdbc:jdbcdslog:postgresql://172.16.1.6:5432/mpinfo;targetDriver=org.postgresql.Driver&amp;lt;/connection-url&amp;gt;
    &amp;lt;driver&amp;gt;jdbcdslog&amp;lt;/driver&amp;gt;
    &amp;lt;new-connection-sql&amp;gt;select 1&amp;lt;/new-connection-sql&amp;gt;
    &amp;lt;transaction-isolation&amp;gt;TRANSACTION_READ_COMMITTED&amp;lt;/transaction-isolation&amp;gt;
    &amp;lt;pool&amp;gt;
    &amp;lt;min-pool-size&amp;gt;10&amp;lt;/min-pool-size&amp;gt;
    &amp;lt;max-pool-size&amp;gt;20&amp;lt;/max-pool-size&amp;gt;
    &amp;lt;/pool&amp;gt;
    &amp;lt;security&amp;gt;
    &amp;lt;user-name&amp;gt;mpinfo&amp;lt;/user-name&amp;gt;
    &amp;lt;password&amp;gt;mpinfo&amp;lt;/password&amp;gt;
    &amp;lt;/security&amp;gt;
    &amp;lt;validation&amp;gt;
    &amp;lt;validate-on-match&amp;gt;false&amp;lt;/validate-on-match&amp;gt;
    &amp;lt;background-validation&amp;gt;false&amp;lt;/background-validation&amp;gt;
    &amp;lt;background-validation-millis&amp;gt;1&amp;lt;/background-validation-millis&amp;gt;
    &amp;lt;/validation&amp;gt;
    &amp;lt;statement&amp;gt;
    &amp;lt;prepared-statement-cache-size&amp;gt;32&amp;lt;/prepared-statement-cache-size&amp;gt;
    &amp;lt;share-prepared-statements&amp;gt;false&amp;lt;/share-prepared-statements&amp;gt;
    &amp;lt;/statement&amp;gt;
&amp;lt;/datasource&amp;gt;

&amp;lt;xa-datasource jndi-name=&amp;quot;java:/mpinfoxads&amp;quot; pool-name=&amp;quot;MPINFO-XA-POOL&amp;quot; enabled=&amp;quot;true&amp;quot; use-ccm=&amp;quot;true&amp;quot;&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;PortNumber&amp;quot;&amp;gt;5432&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;DatabaseName&amp;quot;&amp;gt;mpinfo&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;ServerName&amp;quot;&amp;gt;172.16.1.6&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;xa-datasource-property name=&amp;quot;targetDS&amp;quot;&amp;gt;org.postgresql.xa.PGXADataSource&amp;lt;/xa-datasource-property&amp;gt;
    &amp;lt;driver&amp;gt;jdbcdslog&amp;lt;/driver&amp;gt;
    &amp;lt;new-connection-sql&amp;gt;select 1&amp;lt;/new-connection-sql&amp;gt;
    &amp;lt;transaction-isolation&amp;gt;TRANSACTION_READ_COMMITTED&amp;lt;/transaction-isolation&amp;gt;
    &amp;lt;xa-pool&amp;gt;
        &amp;lt;min-pool-size&amp;gt;0&amp;lt;/min-pool-size&amp;gt;
        &amp;lt;max-pool-size&amp;gt;10&amp;lt;/max-pool-size&amp;gt;
        &amp;lt;flush-strategy&amp;gt;IdleConnections&amp;lt;/flush-strategy&amp;gt;
        &amp;lt;is-same-rm-override&amp;gt;false&amp;lt;/is-same-rm-override&amp;gt;
        &amp;lt;interleaving&amp;gt;false&amp;lt;/interleaving&amp;gt;
        &amp;lt;pad-xid&amp;gt;false&amp;lt;/pad-xid&amp;gt;
        &amp;lt;wrap-xa-resource&amp;gt;false&amp;lt;/wrap-xa-resource&amp;gt;
    &amp;lt;/xa-pool&amp;gt;
    &amp;lt;security&amp;gt;
        &amp;lt;user-name&amp;gt;mpinfo&amp;lt;/user-name&amp;gt;
        &amp;lt;password&amp;gt;mpinfo&amp;lt;/password&amp;gt;
    &amp;lt;/security&amp;gt;
    &amp;lt;validation&amp;gt;
        &amp;lt;valid-connection-checker class-name=&amp;quot;org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLValidConnectionChecker&amp;quot;/&amp;gt;
        &amp;lt;validate-on-match&amp;gt;true&amp;lt;/validate-on-match&amp;gt;
        &amp;lt;background-validation&amp;gt;false&amp;lt;/background-validation&amp;gt;
        &amp;lt;exception-sorter class-name=&amp;quot;org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLExceptionSorter&amp;quot;/&amp;gt;
    &amp;lt;/validation&amp;gt;
    &amp;lt;timeout&amp;gt;
        &amp;lt;idle-timeout-minutes&amp;gt;3&amp;lt;/idle-timeout-minutes&amp;gt;
    &amp;lt;/timeout&amp;gt;
    &amp;lt;statement&amp;gt;
        &amp;lt;track-statements&amp;gt;true&amp;lt;/track-statements&amp;gt;
        &amp;lt;share-prepared-statements&amp;gt;false&amp;lt;/share-prepared-statements&amp;gt;
    &amp;lt;/statement&amp;gt;
&amp;lt;/xa-datasource&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nesse ponto você deve prestar atenção em informações como ips, usuários, senhas e substituir de acordo com o seu ambiente, além disso, perceba que na tag &lt;code&gt;&amp;lt;driver&amp;gt;&lt;/code&gt; usamos o nome do driver do jdbcdslog que definiremos no próximo passo.&lt;/p&gt;
&lt;p&gt;5 - Dentro da tag &lt;code&gt;&amp;lt;datasources&amp;gt;&lt;/code&gt; (standalone.xml)  acrescentar a definição do driver que faz o log:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;drivers&amp;gt;
    &amp;lt;driver name=&amp;quot;jdbcdslog&amp;quot; module=&amp;quot;com.googlecode.usc.jdbcdslog&amp;quot;&amp;gt;
        &amp;lt;driver-class&amp;gt;org.jdbcdslog.DriverLoggingProxy&amp;lt;/driver-class&amp;gt;
        &amp;lt;xa-datasource-class&amp;gt;org.jdbcdslog.XADataSourceProxy&amp;lt;/xa-datasource-class&amp;gt;
    &amp;lt;/driver&amp;gt;
&amp;lt;/drivers&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Pronto, com isso já poderemos usar o datasource e verificar no log do JBoss que qualquer select, update, insert etc que for feito através das conexões desse datasource serão logadas, a saída será algo como:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;11:35:00,066 INFO  [org.jdbcdslog.StatementLogger] (EJB default - 6) select u.password from user u where u.login=&amp;apos;admin&amp;apos;;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Se você usa um XA-DataSource talvez se depare com o seguinte erro:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Caused by: javax.resource.ResourceException: IJ000453: Unable to get managed connection for java:/MPINFO-XA-Datasource

Caused by: java.lang.LinkageError: loader constraint violation: loader (instance of &amp;lt;bootloader&amp;gt;) previously initiated loading for a different type with name &amp;quot;javax/transaction/xa/XAResource&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;A exceção acontece devido a um problema de ClassLoader no JBoss, a questão é que existem duas definições para a classe javax.transaction.xa.XAResource: uma que fica no pacote padrão da JVM e outra que fica num jar dentro do JBoss. Então, por algum motivo, o JBoss carrega a classe a partir da sua lib e o jdbcdslog carrega a classe a partir da lib padrão da JVM (rt.jar) e com isso ocorre a exceção alegando que uma classe com esse mesmo nome já havia sido carregada. Pois bem, para resolver isso ajustei uma configuração no JBoss para evitar que ele carregue a classe que está contida nas suas próprias libs e carregue somente a classe a partir da JVM. O procedimento consiste em alterar o conteúdo do arquivo JBOSS_HOME/modules/system/layers/base/javax/transaction/api/main/module.xml:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;module xmlns=&amp;quot;urn:jboss:module:1.1&amp;quot; name=&amp;quot;javax.transaction.api&amp;quot;&amp;gt;
    &amp;lt;resources&amp;gt;
        &amp;lt;resource-root path=&amp;quot;jboss-transaction-api_1.1_spec-1.0.1.Final-redhat-2.jar&amp;quot;&amp;gt;
            &amp;lt;filter&amp;gt;
                &amp;lt;exclude path=&amp;quot;javax/transaction/xa&amp;quot;/&amp;gt;
                &amp;lt;include path=&amp;quot;**&amp;quot;/&amp;gt;
            &amp;lt;/filter&amp;gt;
        &amp;lt;/resource-root&amp;gt;
    &amp;lt;/resources&amp;gt;
    &amp;lt;dependencies&amp;gt;
        &amp;lt;system export=&amp;quot;true&amp;quot;&amp;gt;
            &amp;lt;paths&amp;gt;
                &amp;lt;path name=&amp;quot;javax/transaction/xa&amp;quot;/&amp;gt;
            &amp;lt;/paths&amp;gt;
        &amp;lt;/system&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/module&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Recomendo que você salve o arquivo original antes de fazer qualquer modificação, ele provavelmente não terá a tag &lt;code&gt;&amp;lt;dependencies&amp;gt;&lt;/code&gt; e também não terá a tag &lt;code&gt;&amp;lt;filter&amp;gt;&lt;/code&gt;. Com esse ajuste terminamos todas as configurações necessárias, agora é testar e verificar que o log gerado está de acordo com os comandos executados.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Uma necessidade básica em quase todos os projetos de software é o log de instruções SQL e para esse fim existe uma infinidade de opções. No entanto, apesar das várias alternativas, muitas vezes o log não é feito da melhor forma:&lt;/p&gt;
    
    </summary>
    
      <category term="JBOSS" scheme="http://marlonpatrick.info/categories/JBOSS/"/>
    
      <category term="SQL" scheme="http://marlonpatrick.info/categories/JBOSS/SQL/"/>
    
      <category term="Log" scheme="http://marlonpatrick.info/categories/JBOSS/SQL/Log/"/>
    
      <category term="Hibernate" scheme="http://marlonpatrick.info/categories/JBOSS/SQL/Log/Hibernate/"/>
    
    
      <category term="Hibernate" scheme="http://marlonpatrick.info/tags/Hibernate/"/>
    
      <category term="JBOSS" scheme="http://marlonpatrick.info/tags/JBOSS/"/>
    
      <category term="JPA" scheme="http://marlonpatrick.info/tags/JPA/"/>
    
      <category term="Log" scheme="http://marlonpatrick.info/tags/Log/"/>
    
      <category term="SQL" scheme="http://marlonpatrick.info/tags/SQL/"/>
    
      <category term="jdbcdslog" scheme="http://marlonpatrick.info/tags/jdbcdslog/"/>
    
  </entry>
  
  <entry>
    <title>JasperReports: Solving NoSuchMethodError to use an image</title>
    <link href="http://marlonpatrick.info/en/2014/04/28/jasperreports-solving-nosuchmethoderror-to-use-an-image/"/>
    <id>http://marlonpatrick.info/en/2014/04/28/jasperreports-solving-nosuchmethoderror-to-use-an-image/</id>
    <published>2014-04-28T12:21:00.000Z</published>
    <updated>2015-08-03T00:48:19.000Z</updated>
    
    <content type="html">&lt;p&gt;The error occurs when you try to generate a report made with Jasper/iReport using an image. The error message is something like: &lt;strong&gt;Caused by: java.lang.NoSuchMethodError: com.lowagie.text.Image.getPlainWidth ()F&amp;lt;/ strong&amp;gt;.&lt;/strong&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;The problem is that you are using a version of iText incompatible with the version of JasperReports. Until the version 3.0.0 of the Jasper/iReport the correct version of iText is 1.3.1. Starting with version 3.1.0 of the Jasper/iReport the correct version of iText is 2.1.0.&lt;/p&gt;
&lt;p&gt;A better tip is to check the lib folder of your iReport which will contain all the libs with their correct versions, so you can ensure you are using the appropriate version of each dependency of JasperReports.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;The error occurs when you try to generate a report made with Jasper/iReport using an image. The error message is something like: &lt;strong&gt;Caused by: java.lang.NoSuchMethodError: com.lowagie.text.Image.getPlainWidth ()F&amp;lt;/ strong&amp;gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="JasperReports" scheme="http://marlonpatrick.info/categories/JasperReports/"/>
    
      <category term="iReport" scheme="http://marlonpatrick.info/categories/JasperReports/iReport/"/>
    
    
      <category term="JasperReports" scheme="http://marlonpatrick.info/tags/JasperReports/"/>
    
      <category term="iReport" scheme="http://marlonpatrick.info/tags/iReport/"/>
    
      <category term="iText" scheme="http://marlonpatrick.info/tags/iText/"/>
    
  </entry>
  
  <entry>
    <title>JasperReports: Resolvendo NoSuchMethodError ao usar uma imagem</title>
    <link href="http://marlonpatrick.info/pt-br/2014/04/28/jasperreports-resolvendo-nosuchmethoderror-ao-usar-uma-imagem/"/>
    <id>http://marlonpatrick.info/pt-br/2014/04/28/jasperreports-resolvendo-nosuchmethoderror-ao-usar-uma-imagem/</id>
    <published>2014-04-28T12:21:00.000Z</published>
    <updated>2015-08-02T13:14:51.000Z</updated>
    
    <content type="html">&lt;p&gt;O erro acontece quando você tenta gerar um relatório feito com Jasper/iReport que usa uma imagem. A mensagem de erro é algo como: &lt;strong&gt;Caused by: java.lang.NoSuchMethodError: com.lowagie.text.Image.getPlainWidth()F&lt;/strong&gt;.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;O problema é que você está usando uma versão do iText incompatível com a versão do JasperReports. Até a versão 3.0.0 do Jasper/iReport a versão correta do iText é 1.3.1. A partir da versão 3.1.0 do Jasper/iReport a versão correta do iText é 2.1.0.&lt;/p&gt;
&lt;p&gt;Uma dica melhor é verificar a pasta lib do seu iReport o qual irá conter todas as libs com suas versões corretas, assim, pode garantir que está usando a versão adequada de cada dependência do Jasper.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;O erro acontece quando você tenta gerar um relatório feito com Jasper/iReport que usa uma imagem. A mensagem de erro é algo como: &lt;strong&gt;Caused by: java.lang.NoSuchMethodError: com.lowagie.text.Image.getPlainWidth()F&lt;/strong&gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="JasperReports" scheme="http://marlonpatrick.info/categories/JasperReports/"/>
    
      <category term="iReport" scheme="http://marlonpatrick.info/categories/JasperReports/iReport/"/>
    
    
      <category term="JasperReports" scheme="http://marlonpatrick.info/tags/JasperReports/"/>
    
      <category term="iReport" scheme="http://marlonpatrick.info/tags/iReport/"/>
    
      <category term="iText" scheme="http://marlonpatrick.info/tags/iText/"/>
    
  </entry>
  
  <entry>
    <title>PrimeFaces: around problems with resizable/draggable dataTable</title>
    <link href="http://marlonpatrick.info/en/2014/04/26/primefaces-around-problems-with-resizable-slash-draggable-datatable/"/>
    <id>http://marlonpatrick.info/en/2014/04/26/primefaces-around-problems-with-resizable-slash-draggable-datatable/</id>
    <published>2014-04-26T19:29:00.000Z</published>
    <updated>2015-08-03T02:48:48.000Z</updated>
    
    <content type="html">&lt;p&gt;I will leave here workarounds for some PrimeFaces bugs when using dataTable with features resizable or draggable. Some of these bugs have been corrected, but if for some reason you like me works with any version of PrimeFaces containing the error and can not update it will be of great help.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;strong&gt;1 - NullPointerException to resize the size of a column (fixed in version 3.5)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The problem occurs in a dataTable which is resizable and draggable at the same time. I found the following tickets in the PrimeFaces issue tracker to address the problem: &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=3674&quot; title=&quot;Issue 3674&quot; target=&quot;_blank&quot;&gt;3674&lt;/a&gt;, &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4012&quot; title=&quot;Issue 4012&quot; target=&quot;_blank&quot;&gt;4012&lt;/a&gt;,&lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4796&quot; title=&quot;Issue 4796&quot; target=&quot;_blank&quot;&gt;4796&lt;/a&gt; and &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=5167&quot; title=&quot;Issue 5167&quot; target=&quot;_blank&quot;&gt;5167&lt;/a&gt;. In version 3.4.1 of PrimeFaces the error log is something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;01:40:49,907 INFO  [javax.enterprise.resource.webcontainer.jsf.context] (http--0.0.0.0-8080-1) java.lang.NullPointerException: java.lang.NullPointerException
at org.primefaces.component.datatable.feature.ResizableColumnsFeature.decode(ResizableColumnsFeature.java:35) [primefaces-3.4.1.jar:]
at org.primefaces.component.datatable.DataTableRenderer.decode(DataTableRenderer.java:53) [primefaces-3.4.1.jar:]
at javax.faces.component.UIComponentBase.decode(UIComponentBase.java:787) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
at org.primefaces.component.api.UIData.processDecodes(UIData.java:224) [primefaces-3.4.1.jar:]
at com.sun.faces.context.PartialViewContextImpl$PhaseAwareVisitCallback.visit(PartialViewContextImpl.java:506) [jsf-impl-2.1.7-jbossorg-2.jar:]
at com.sun.faces.component.visit.PartialVisitContext.invokeVisitCallback(PartialVisitContext.java:183) [jsf-impl-2.1.7-jbossorg-2.jar:]
at org.primefaces.component.api.UIData.visitTree(UIData.java:635) [primefaces-3.4.1.jar:]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Briefly the error happens because when you resize a column the PrimeFaces processes both resizing (resize) and the reordering (reorder) of the column. This can be easily realized if you use the colResize and colReorder event to generate a log.&lt;/p&gt;
&lt;p&gt;A detailed explanation is as follows: to create the effect of the resize a column PrimeFaces creates a tag &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; in the header of the column and makes this tag an object &lt;a href=&quot;http://jqueryui.com/draggable/&quot; title=&quot;jQuery UI - Draggable&quot; target=&quot;_blank&quot;&gt;draggable&lt;/a&gt;, thus when the user drags the “column” for her to stay greater or minor and loose there is a “collision” between the resizer and reorder feature of dataTable. This is because the report that the dataTable is draggable the PrimeFaces makes all draggable columns so that they can be dragged and reordered and makes the whole table header &lt;a href=&quot;http://jqueryui.com/droppable/&quot; title=&quot; jQuery UI - Droppable&quot; target=&quot;_blank&quot;&gt;droppable&lt;/a&gt;. The problem is that the implementation of PrimeFaces missed configuring the droppable to accept only reordering columns and thus to release the &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; that resizes to the drop reordering of the column is used and the PrimeFaces understands that the column is being reordered and resized, with this method you should adjust the size of the column does not receive a parameter (the id of the resized column) it needs to function properly and then causes the error.&lt;/p&gt;
&lt;p&gt;To solve this problem I added a script after closing the tag &lt;code&gt;&amp;lt;p:dataTable&amp;gt;&lt;/code&gt; that defines a specific scope for ‘&lt;span&gt;‘ which is used in resizing columns. So, to resize a column even if the user release the mouse on the table header of the drop column reordering will not be called because the draggable object ‘&lt;span&gt;‘ has a different scope of droppable object (table header). The code is as follows:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;p:dataTable draggableColumns=&amp;quot;true&amp;quot; resizableColumns=&amp;quot;true&amp;quot;&amp;gt;
       &amp;lt;!-- your code --&amp;gt;
&amp;lt;/ p: dataTable&amp;gt;

&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    $( &amp;quot;.ui-column-resizer&amp;quot; ).draggable( &amp;quot;option&amp;quot;, &amp;quot;scope&amp;quot;, &amp;apos;resizer&amp;apos;);//resizer is the name of the scope that chose, could be any other name
&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2 - NullPointerException to resize a dynamic column (fixed in version 3.5.7)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In this case simply just have a resizable dataTable with dynamic columns so that the error happens. I found the following tickets in the PrimeFaces issue tracker to address the problem: &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4238&quot; title=&quot;Issue 4238&quot; target=&quot;_blank&quot;&gt;4238&lt;/a&gt; and &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4797&quot; title=&quot;Issue 4797&quot; target=&quot;_blank&quot;&gt;4797&lt;/a&gt;. Funny that even with several people reporting the problem the PrimeFaces the team scored both issues as “Unable to replicate.” According to one observer the problem was resolved in version 3.5.7, but could not prove.&lt;/p&gt;
&lt;p&gt;The point where the error occurs is the same as the case described above, so the log is similar and only what changes is the root cause of the problem. Previously, the NullPointer reason is that the parameter with the id of the resized column is not sent to the server, as in the case of dynamic columns, even when the id is sent PrimeFaces can not find the corresponding column. The method that is used to fetch the column by id is &lt;code&gt;DataTable.findColumn (String clinetId)&lt;/code&gt; which only looks for simple columns and ignores the dynamics.&lt;/p&gt;
&lt;p&gt;In my case, it was not so important that the Column object were found and that their width field was setted as the width used on my screen is stored in another specific object of my system. So my solution was only override the class that processes the resize the dataTable event (org.primefaces.component.datatable.feature.ResizableColumnsFeature), but specifically the decode method:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Override
public void decode(FacesContext context, DataTable table) {
    Map&amp;lt;String, String&amp;gt; params = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap();
    String clientId = table.getClientId();

    String columnId = params.get(clientId + &amp;quot;_columnId&amp;quot;);
    String width = params.get(clientId + &amp;quot;_width&amp;quot;);
    Column column = table.findColumn(columnId);

    if(column != null){ //added this if that to avoid NullPointerException
        column.setWidth(Integer.parseInt(width));
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dessa forma o evento colResize pode ser invocado e é através dele que resolvo meu problema. Talvez o código seja difícil de aplicar em outro sistema, mas, de toda forma vou deixar aqui pelo menos para você ter uma idéia de como fiz e poder adaptar a solução:&lt;/p&gt;
&lt;p&gt;Thus the colResize event can be invoked and it is through him that solve my problem. Perhaps the code is difficult to apply in another system, but anyway I will leave here at least you get an idea of how I did and be able to adapt the solution:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public void onResizeColumn(ColumnResizeEvent event) {
    if (event.getColumn() == null) {
        String index = getColumnIndex(event);
        DynaColumn dynaColumn = this.getColumns().get(Integer.parseInt(index));//getColumns() is the list you use to generate the dynamic columns
        dynaColumn.setWidth(event.getWidth());//DynaColumn is a particular object of my system
    }
}

private String getColumnIndex(ColumnResizeEvent event) {
    String columnId = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get(event.getComponent().getClientId() + &amp;quot;_columnId&amp;quot;);
    String[] columnIdSplited = columnId.split(&amp;quot;:&amp;quot;);
    return columnIdSplited[columnIdSplited.length - 1];
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In my JSF page using the DynaColumn.width field to set the size of the column even if the Column object PrimeFaces has not been updated.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;p:dataTable resizableColumns=&amp;quot;true&amp;quot;&amp;gt;
       &amp;lt;!-- your code --&amp;gt;
    &amp;lt;p:columns value=&amp;quot;#{viewManager.columns}&amp;quot; var=&amp;quot;dynaColumn&amp;quot;&amp;gt;
           &amp;lt;!-- your code --&amp;gt;
    &amp;lt;/p:columns&amp;gt;
&amp;lt;/ p: dataTable&amp;gt;

&amp;lt;ui:repeat var=&amp;quot;dynaColumn&amp;quot; value=&amp;quot;#{viewManager.columns}&amp;quot; varStatus=&amp;quot;status&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
        var columnWidth = #{dynaColumn.width};
        if(columnWidth &amp;gt; 0){
            $(&amp;apos;[id=&amp;quot;dataTableID:dynamicColumns:#{status.index}&amp;quot;]&amp;apos;).
                children(&amp;apos;.ui-dt-c&amp;apos;).css(&amp;apos;width&amp;apos;,columnWidth);
        }
    &amp;lt;/script&amp;gt;                
&amp;lt;/ui:repeat&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The issue &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4238&quot; title=&quot;Issue 4238&quot; target=&quot;_blank&quot;&gt;4238&lt;/a&gt; proposes another way around the problem, in addition, other possible solutions would adjust the ResizableColumnsFeature.decode method to search the column the right way or else the onResize set the Column object rather than a system object itself. If any of these fixes will be implemented javascript would not be necessary to adjust the width of columns in the JSF page thus simplifying the solution. In my case there is a business requirement that forced me to make the form presented here.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3 - colReorder event runs for any ajax call and not only in the column reordering&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;To simulate this error simply just have a draggable dataTable and make any ajax call on the screen. I found the ticket &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4985&quot; title=&quot;Issue 4985&quot; target=&quot;_blank&quot;&gt;4985&lt;/a&gt; in the rimeFaces issue tracker that addresses the problem. The same was marked “not be corrected,” then I believe still happen in any version.&lt;/p&gt;
&lt;p&gt;To solve the problem I overwrite the org.primefaces.component.datatable.feature.DraggableColumnsFeature class to adjust the shouldDecode method:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Override
public boolean shouldDecode(FacesContext context, DataTable table) {
  return table.isDraggableColumns() &amp;amp;&amp;amp; this.isDragRequest(context);
}

private boolean isDragRequest(FacesContext context) {
  String eventName =  context.getExternalContext().getRequestParameterMap().get(&amp;quot;javax.faces.behavior.event&amp;quot;);

  if(&amp;quot;colReorder&amp;quot;.equals(eventName)){
    return true;
  }

  return false;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thus, the colReorder event will now be called at the appropriate time.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;I will leave here workarounds for some PrimeFaces bugs when using dataTable with features resizable or draggable. Some of these bugs have been corrected, but if for some reason you like me works with any version of PrimeFaces containing the error and can not update it will be of great help.&lt;/p&gt;
    
    </summary>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/categories/PrimeFaces/"/>
    
    
      <category term="DataTable" scheme="http://marlonpatrick.info/tags/DataTable/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/tags/PrimeFaces/"/>
    
  </entry>
  
  <entry>
    <title>PrimeFaces: contornando problemas com dataTable resizable/draggable</title>
    <link href="http://marlonpatrick.info/pt-br/2014/04/26/primefaces-contornando-problemas-com-datatable-resizable-slash-draggable/"/>
    <id>http://marlonpatrick.info/pt-br/2014/04/26/primefaces-contornando-problemas-com-datatable-resizable-slash-draggable/</id>
    <published>2014-04-26T19:29:00.000Z</published>
    <updated>2015-08-02T13:14:51.000Z</updated>
    
    <content type="html">&lt;p&gt;Vou deixar aqui soluções alternativas para alguns bugs do PrimeFaces quando se usa dataTable com as features resizable ou draggable. Alguns desses bugs já foram corrigidos, mas, se por algum motivo você assim como eu trabalha com alguma versão do PrimeFaces que contém o erro e não pode atualizá-la será de grande ajuda.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;strong&gt;1 - NullPointerException ao redimensionar o tamanho de uma coluna (corrigido na versão 3.5)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;O problema acontece num dataTable que é resizable e draggable ao mesmo tempo. Encontrei os seguintes tickets no issue tracker do PrimeFaces para tratar do problema: &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=3674&quot; title=&quot;Issue 3674&quot; target=&quot;_blank&quot;&gt;3674&lt;/a&gt;, &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4012&quot; title=&quot;Issue 4012&quot; target=&quot;_blank&quot;&gt;4012&lt;/a&gt;,&lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4796&quot; title=&quot;Issue 4796&quot; target=&quot;_blank&quot;&gt;4796&lt;/a&gt; e &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=5167&quot; title=&quot;Issue 5167&quot; target=&quot;_blank&quot;&gt;5167&lt;/a&gt;. Na versao 3.4.1 do PrimeFaces o log do erro é algo como:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;01:40:49,907 INFO  [javax.enterprise.resource.webcontainer.jsf.context] (http--0.0.0.0-8080-1) java.lang.NullPointerException: java.lang.NullPointerException
at org.primefaces.component.datatable.feature.ResizableColumnsFeature.decode(ResizableColumnsFeature.java:35) [primefaces-3.4.1.jar:]
at org.primefaces.component.datatable.DataTableRenderer.decode(DataTableRenderer.java:53) [primefaces-3.4.1.jar:]
at javax.faces.component.UIComponentBase.decode(UIComponentBase.java:787) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
at org.primefaces.component.api.UIData.processDecodes(UIData.java:224) [primefaces-3.4.1.jar:]
at com.sun.faces.context.PartialViewContextImpl$PhaseAwareVisitCallback.visit(PartialViewContextImpl.java:506) [jsf-impl-2.1.7-jbossorg-2.jar:]
at com.sun.faces.component.visit.PartialVisitContext.invokeVisitCallback(PartialVisitContext.java:183) [jsf-impl-2.1.7-jbossorg-2.jar:]
at org.primefaces.component.api.UIData.visitTree(UIData.java:635) [primefaces-3.4.1.jar:]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;De maneira resumida o erro acontece porque ao redimensionar uma coluna o PrimeFaces processa tanto o redimensionamento (resize) quanto a reordenação da coluna (reorder). Isso pode ser facilmente percebido se você usar os eventos colResize e colReorder para gerar algum log.&lt;/p&gt;
&lt;p&gt;A explicação detalhada é a seguinte: para criar o efeito de redimensionar uma coluna o PrimeFaces cria uma tag &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; no cabeçalho da coluna e torna essa tag um objeto &lt;a href=&quot;http://jqueryui.com/draggable/&quot; title=&quot;jQuery UI - Draggable&quot; target=&quot;_blank&quot;&gt;draggable&lt;/a&gt;, dessa forma, quando o usuário arrasta a “coluna” para ela ficar maior ou menor e a solta ocorre uma “colisão” entre a funcionalidade resizer e reorder do dataTable. Isso porque, ao informar que o dataTable é draggable o PrimeFaces torna todas as colunas draggable de modo que as mesmas possam ser arrastadas e reordenadas bem como torna todo o cabeçalho da tabela &lt;a href=&quot;http://jqueryui.com/droppable/&quot; title=&quot;jQuery UI - Droppable&quot; target=&quot;_blank&quot;&gt;droppable&lt;/a&gt;. O problema é que a implementação do PrimeFaces esqueceu de configurar o droppable para aceitar apenas reordenação de colunas e com isso ao soltar o &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; que redimensiona a coluna o drop da reordenação é invocado e o PrimeFaces entende que a coluna está sendo reordenada e redimensionada, com isso o método que deveria ajustar o tamanho da coluna não recebe um parâmetro (o id da coluna redimensionada) que precisa para funcionar corretamente e então provoca o erro.&lt;/p&gt;
&lt;p&gt;Para solucionar esse problema adicionei um script após o fechamento da tag &lt;code&gt;&amp;lt;p:dataTable&amp;gt;&lt;/code&gt; que define um escopo específico para o &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; que é usado no redimensionamento das colunas. Assim, ao redimensionar uma coluna mesmo que o usuário solte o mouse sobre o cabeçalho da tabela o drop da reordenação de colunas não será chamado, pois, o objeto draggable &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; possui um escopo diferente do objeto droppable (cabeçalho da tabela). O código fica da seguinte forma:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;p:dataTable draggableColumns=&amp;quot;true&amp;quot; resizableColumns=&amp;quot;true&amp;quot;&amp;gt;
       &amp;lt;!-- your code --&amp;gt;
&amp;lt;/ p: dataTable&amp;gt;

&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    $( &amp;quot;.ui-column-resizer&amp;quot; ).draggable( &amp;quot;option&amp;quot;, &amp;quot;scope&amp;quot;, &amp;apos;resizer&amp;apos;);//resizer é o nome do escopo que escolhi, poderia ser qualquer outro nome
&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;2 - NullPointerException ao redimensionar uma coluna dinâmica (corrigido na versão 3.5.7)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Nesse caso basta apenas ter um dataTable resizable com colunas dinâmicas para que o erro aconteça. Encontrei os seguintes tickets no issue tracker do PrimeFaces para tratar do problema: &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4238&quot; title=&quot;Issue 4238&quot; target=&quot;_blank&quot;&gt;4238&lt;/a&gt; e &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4797&quot; title=&quot;Issue 4797&quot; target=&quot;_blank&quot;&gt;4797&lt;/a&gt;. Engraçado que mesmo com várias pessoas relatando o problema o time do PrimeFaces marcou ambos issues como “Não foi possível replicar”. Segundo um dos observadores o problema foi resolvido na versão 3.5.7, mas, não pude comprovar.&lt;/p&gt;
&lt;p&gt;O ponto onde acontece o erro é o mesmo do caso descrito acima, assim, o log é semelhante e só o que muda é a causa raiz do problema. No item anterior, o motivo do NullPointer é que o parâmetro com o id da coluna redimensionada não é enviado para o servidor, já no caso das colunas dinâmicas, mesmo quando o id é enviado o PrimeFaces não consegue encontrar a coluna correspondente. O método que é usado para buscar a coluna pelo id é o &lt;code&gt;DataTable.findColumn(String clinetId)&lt;/code&gt; o qual só procura por colunas simples e desconsidera as dinâmicas.&lt;/p&gt;
&lt;p&gt;No meu caso, não era tão importante que o objeto Column fosse achado e que o seu campo width fosse setado pois o width usado na minha tela fica armazenado num outro objeto específico do meu sistema. Por isso minha solução foi apenas sobrescrever a classe que processa o evento resize do dataTable (org.primefaces.component.datatable.feature.ResizableColumnsFeature), mas especificamente o método decode:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Override
public void decode(FacesContext context, DataTable table) {
    Map&amp;lt;String, String&amp;gt; params = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap();
    String clientId = table.getClientId();

    String columnId = params.get(clientId + &amp;quot;_columnId&amp;quot;);
    String width = params.get(clientId + &amp;quot;_width&amp;quot;);
    Column column = table.findColumn(columnId);

    if(column != null){ // adicionei esse if para evitar a NullPointerException 
        column.setWidth(Integer.parseInt(width));
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dessa forma o evento colResize pode ser invocado e é através dele que resolvo meu problema. Talvez o código seja difícil de aplicar em outro sistema, mas, de toda forma vou deixar aqui pelo menos para você ter uma idéia de como fiz e poder adaptar a solução:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public void onResizeColumn(ColumnResizeEvent event) {
    if (event.getColumn() == null) {
        String index = getColumnIndex(event);
        DynaColumn dynaColumn = this.getColumns().get(Integer.parseInt(index));//getColumns() é a lista que uso para gerar as colunas dinâmicas
        dynaColumn.setWidth(event.getWidth());//DynaColumn é um objeto específico do meu sistema
    }
}

private String getColumnIndex(ColumnResizeEvent event) {
    String columnId = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get(event.getComponent().getClientId() + &amp;quot;_columnId&amp;quot;);
    String[] columnIdSplited = columnId.split(&amp;quot;:&amp;quot;);
    return columnIdSplited[columnIdSplited.length - 1];
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Na minha página JSF uso o campo DynaColumn.width para setar o tamanho da coluna mesmo que o objeto Column do PrimeFaces não tenha sido atualizado.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;p:dataTable resizableColumns=&amp;quot;true&amp;quot;&amp;gt;
       &amp;lt;!-- your code --&amp;gt;
    &amp;lt;p:columns value=&amp;quot;#{viewManager.columns}&amp;quot; var=&amp;quot;dynaColumn&amp;quot;&amp;gt;
           &amp;lt;!-- your code --&amp;gt;
    &amp;lt;/p:columns&amp;gt;
&amp;lt;/ p: dataTable&amp;gt;

&amp;lt;ui:repeat var=&amp;quot;dynaColumn&amp;quot; value=&amp;quot;#{viewManager.columns}&amp;quot; varStatus=&amp;quot;status&amp;quot;&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
        var columnWidth = #{dynaColumn.width};
        if(columnWidth &amp;gt; 0){
            $(&amp;apos;[id=&amp;quot;idDoDataTable:dynamicColumns:#{status.index}&amp;quot;]&amp;apos;).
                children(&amp;apos;.ui-dt-c&amp;apos;).css(&amp;apos;width&amp;apos;,columnWidth);
        }
    &amp;lt;/script&amp;gt;                
&amp;lt;/ui:repeat&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;A issue &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4238&quot; title=&quot;Issue 4238&quot; target=&quot;_blank&quot;&gt;4238&lt;/a&gt; propõe uma outra forma de contornar o problema, além disso, outras soluções possíveis seriam ajustar o método ResizableColumnsFeature.decode para procurar a coluna da maneira certa ou então no onResize setar o objeto Column ao invés de um objeto próprio do sistema. Caso alguma dessas correções seja implementada não seria necessário o javascript para ajustar o width das colunas na página JSF o que simplificaria a solução. No meu caso específico há um requisito de negócio que me forçou a fazer da forma aqui apresentada.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3 - Evento colReorder é executado para qualquer chamada ajax e não apenas na reordenação de colunas&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Para simular esse erro basta apenas ter um dataTable draggable e fazer qualquer chamada ajax na tela. Encontrei o ticket &lt;a href=&quot;https://code.google.com/p/primefaces/issues/detail?id=4985&quot; title=&quot;Issue 4985&quot; target=&quot;_blank&quot;&gt;4985&lt;/a&gt; no issue tracker do PrimeFaces que aborda o problema. O mesmo foi marcado como “Não será corrigido”, então, acredito que ainda aconteça em qualquer versão.&lt;/p&gt;
&lt;p&gt;Para resolver o problema sobrescrevi a classe org.primefaces.component.datatable.feature.DraggableColumnsFeature para ajustar o método shouldDecode:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Override
public boolean shouldDecode(FacesContext context, DataTable table) {
  return table.isDraggableColumns() &amp;amp;&amp;amp; this.isDragRequest(context);
}

private boolean isDragRequest(FacesContext context) {
  String eventName =  context.getExternalContext().getRequestParameterMap().get(&amp;quot;javax.faces.behavior.event&amp;quot;);

  if(&amp;quot;colReorder&amp;quot;.equals(eventName)){
    return true;
  }

  return false;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dessa forma, o evento colReorder agora será chamado no momento apropriado.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Vou deixar aqui soluções alternativas para alguns bugs do PrimeFaces quando se usa dataTable com as features resizable ou draggable. Alguns desses bugs já foram corrigidos, mas, se por algum motivo você assim como eu trabalha com alguma versão do PrimeFaces que contém o erro e não pode atualizá-la será de grande ajuda.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/categories/JSF/PrimeFaces/"/>
    
    
      <category term="DataTable" scheme="http://marlonpatrick.info/tags/DataTable/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/tags/PrimeFaces/"/>
    
  </entry>
  
  <entry>
    <title>EJB 3.1: Stateless Session Beans and reinjection dependencies</title>
    <link href="http://marlonpatrick.info/en/2013/09/04/ejb-3-dot-1-stateless-session-beans-and-dependencies-reinjection/"/>
    <id>http://marlonpatrick.info/en/2013/09/04/ejb-3-dot-1-stateless-session-beans-and-dependencies-reinjection/</id>
    <published>2013-09-05T01:50:00.000Z</published>
    <updated>2015-08-02T18:12:34.000Z</updated>
    
    <content type="html">&lt;p&gt;When you start working with EJB one of the first things to learn is about the different types of beans, which at 3.1 specification are: Stateful Session Beans (SFSB), Stateless Session Beans (SLSB), Singleton Sessions Beans and Message-Drive Beans. With this comes one of the most common questions: “What is the difference between Stateful and Stateless beans?”. Well, this post is not one to explain these differences, if you need that follows a good &lt;a target=&quot;_ blank&quot; href=&quot;http://www.theserverside.com/tutorial/Which-EJB-to-use-Stateful-stateless-and-singleton-session-beans-compared&quot;&gt;link&lt;/a&gt;.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;But to my post need to make sense to put the standard response:. “SFSBs preserve the state even if they occur several calls methods in the bean as the container ensures that the customer will always be serviced by the same instance. Already SLSBs not preserve state because, for each method call the customer makes it can be serviced by a different instance.”&lt;/p&gt;
&lt;p&gt;However, with the advent of CDI and its powerful dependency injection mechanism that changes a bit, because even a SLSB can have a “pseudo conversational state” when using this feature. Most developers (including me until this afternoon) believes that the injection of dependencies for an EJB happens only during instance creation and thus assume things like, “I can not inject a managed bean @SessionScoped in an SLSB, for as I have no guarantee of being always attended by the same instance I can get one that has the managed bean to another session”.&lt;/p&gt;
&lt;p&gt;In fact it is not so, I found it today and if he knew me before would have avoided big headache, so I decided to share here. The EJB 3.1 specification on page 74 item 4.3.2 says the following:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If a session bean makes use of dependency injection, the container injects these references after the bean instance is created, and before any business methods are invoked on the bean instance.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ie the dependency injection is done after creating the bean instance and also before each call of a business method. This was very useful for me, as was already racking their brains on how to keep the EntityManager to inject in my EJBs (through Seam Managed Persistence Context my EntityManager is a @ConversationScoped) according to the EJB client context. As the container reinjected dependencies before each method call actually I do not even need to have worried about it.&lt;/p&gt;
&lt;p&gt;Somehow, this definition can give SLSBs the ability to have a “conversational state”. For example, if you inject in a SLSB a bean with session scope (@SessionScoped), regardless of which pool instance process your request the bean is session-scoped always according to the current client session. In other words, there is no possibility of a SLSB have a session bean another client. This allows a SLSB receive the user logged in as an instance field through @Inject without causing any problem if two users use the same instance of SLSB alternately. For example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Stateless
public class StatelessSessionBean{
    @Inject
    @LoggedInUser
    protected User loggedInUser;//@SessionScoped

    public void test(){
        System.out.println(&amp;quot;ejb:&amp;quot;+this);
        System.out.println(&amp;quot;user:&amp;quot;+this.loggedInUser);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then the result of several calls the method “test” by different users is as follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;User 1 invoke
17:02:20,800 INFO  [stdout] (http--0.0.0.0-8080-5) ejb:StatelessSessionBean@406189
17:02:20,801 INFO  [stdout] (http--0.0.0.0-8080-5) user:User 1

User 2 invoke
17:02:56,227 INFO  [stdout] (http--0.0.0.0-8080-8) ejb:StatelessSessionBean@406189
17:02:56,228 INFO  [stdout] (http--0.0.0.0-8080-8) user:User 2

User 2 invoke
17:03:24,376 INFO  [stdout] (http--0.0.0.0-8080-8) ejb:StatelessSessionBean@406189
17:03:24,378 INFO  [stdout] (http--0.0.0.0-8080-8) user:User 2

User 1 invoke
17:03:24,517 INFO  [stdout] (http--0.0.0.0-8080-6) ejb:StatelessSessionBean@1c05227
17:03:24,518 INFO  [stdout] (http--0.0.0.0-8080-6) user:User 1

User 1 invoke
17:04:24,045 INFO  [stdout] (http--0.0.0.0-8080-1) ejb:StatelessSessionBean@406189
17:04:24,047 INFO  [stdout] (http--0.0.0.0-8080-1) user:User 1

User 2 invoke
17:04:24,179 INFO  [stdout] (http--0.0.0.0-8080-8) ejb:StatelessSessionBean@1c05227
17:04:24,179 INFO  [stdout] (http--0.0.0.0-8080-8) user:User 2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note that even being serviced by the same instance, the field “loggedInUser” varies correctly according to the user that invoked the method.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;When you start working with EJB one of the first things to learn is about the different types of beans, which at 3.1 specification are: Stateful Session Beans (SFSB), Stateless Session Beans (SLSB), Singleton Sessions Beans and Message-Drive Beans. With this comes one of the most common questions: “What is the difference between Stateful and Stateless beans?”. Well, this post is not one to explain these differences, if you need that follows a good &lt;a target = &quot;_ blank&quot; href=&quot;http://www.theserverside.com/tutorial/Which-EJB-to-use-Stateful-stateless-and-singleton-session-beans-compared&quot;&gt;link&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="EJB" scheme="http://marlonpatrick.info/categories/EJB/"/>
    
    
      <category term="CDI" scheme="http://marlonpatrick.info/tags/CDI/"/>
    
      <category term="Dependency Injection" scheme="http://marlonpatrick.info/tags/Dependency-Injection/"/>
    
      <category term="Stateless Session Bean" scheme="http://marlonpatrick.info/tags/Stateless-Session-Bean/"/>
    
  </entry>
  
  <entry>
    <title>EJB 3.1: Stateless Session Beans e a reinjeção de dependências</title>
    <link href="http://marlonpatrick.info/pt-br/2013/09/04/ejb-3-dot-1-stateless-session-beans-e-a-reinjecao-de-dependencias/"/>
    <id>http://marlonpatrick.info/pt-br/2013/09/04/ejb-3-dot-1-stateless-session-beans-e-a-reinjecao-de-dependencias/</id>
    <published>2013-09-05T01:50:00.000Z</published>
    <updated>2015-08-02T18:05:21.000Z</updated>
    
    <content type="html">&lt;p&gt;Quando se começa a trabalhar com EJB uma das primeiras coisas a se aprender é sobre os diferentes tipos de beans, que na especificação 3.1 são: Stateful Session Beans (SFSB), Stateless Session Beans (SLSB), Singleton Sessions Beans e os Message-Drive Beans. Com isso vem uma das dúvidas mais comuns: “Qual a diferença entre beans Stateful e Stateless?”. Bem, esse post não é mais um para explicar essas diferenças, se você precisa disso segue um bom &lt;a target=&quot;_blank&quot; href=&quot;http://www.theserverside.com/tutorial/Which-EJB-to-use-Stateful-stateless-and-singleton-session-beans-compared&quot;&gt;link&lt;/a&gt;.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Mas, para o meu post fazer sentido preciso colocar a resposta padrão: “SFSBs preservam o estado mesmo que ocorram várias chamadas de métodos no bean, pois, o container garante que o cliente vai ser sempre atendido pela mesma instância. Já os SLSBs não preservam estado, pois, para cada chamada de método que o cliente faz ele pode ser atendido por uma instância diferente.”&lt;/p&gt;
&lt;p&gt;Porém, com o advento do CDI e o seu poderoso mecanismo de injeção de dependências isso muda um pouco, pois, mesmo um SLSB pode ter um “pseudo conversational state” quando usa esse recurso. A maioria dos desenvolvedores (inclusive eu até hoje a tarde) acredita que a injeção de dependências de um EJB acontece apenas durante a criação da instância e com isso supõem coisas como: “Não posso injetar um managed bean @SessionScoped num SLSB, pois, como não tenho garantia de ser atendido sempre pela mesma instância posso obter uma que tem o managed bean de uma outra sessão”.&lt;/p&gt;
&lt;p&gt;Na verdade não é bem assim, descobri isso hoje e se soubesse antes teria me evitado uma grande dor de cabeça, por isso resolvi compartilhar aqui. A especificação EJB 3.1 na página 74 item 4.3.2 fala o seguinte:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If a session bean makes use of dependency injection, the container injects these references after the bean instance is created, and before any business methods are invoked on the bean instance.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ou seja, a injeção de dependências é feita depois de criar a instância do bean e também antes de cada chamada de um método de negócio. Isso foi de grande valia para mim, pois, já estava quebrando a cabeça em como manteria o EntityManager que injeto nos meus EJBs (através do Seam Managed Persistence Context meu EntityManager é um @ConversationScoped) de acordo com o contexto do cliente do EJB. Como o container reinjeta as dependências antes de cada chamada de método na verdade eu nem precisava ter me preocupado com isso.&lt;/p&gt;
&lt;p&gt;De alguma forma, essa definição pode dar aos SLSBs a capacidade de ter um “estado de conversação”. Por exemplo, se você injetar em um SLSB um bean com escopo de sessão (@SessionScoped), independentemente de qual instância do pool processar sua solicitação o bean com escopo de sessão sempre estará de acordo com a sessão do cliente atual. Em outras palavras, não existe a possibilidade de um SLSB ter um bean de sessão de outro cliente. Isso permite que uma SLSB receba o usuário logado como um campo de instância através de @Inject sem causar nenhum problema caso dois usuários usem a mesma instância do SLSB alternadamente. Por exemplo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Stateless
public class StatelessSessionBean{
    @Inject
    @LoggedInUser
    protected User loggedInUser;//@SessionScoped

    public void test(){
        System.out.println(&amp;quot;ejb:&amp;quot;+this);
        System.out.println(&amp;quot;user:&amp;quot;+this.loggedInUser);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Então o resultado de várias chamadas do método “test” por usuários diferentes é a seguinte:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;User 1 invoke
17:02:20,800 INFO  [stdout] (http--0.0.0.0-8080-5) ejb:StatelessSessionBean@406189
17:02:20,801 INFO  [stdout] (http--0.0.0.0-8080-5) user:User 1

User 2 invoke
17:02:56,227 INFO  [stdout] (http--0.0.0.0-8080-8) ejb:StatelessSessionBean@406189
17:02:56,228 INFO  [stdout] (http--0.0.0.0-8080-8) user:User 2

User 2 invoke
17:03:24,376 INFO  [stdout] (http--0.0.0.0-8080-8) ejb:StatelessSessionBean@406189
17:03:24,378 INFO  [stdout] (http--0.0.0.0-8080-8) user:User 2

User 1 invoke
17:03:24,517 INFO  [stdout] (http--0.0.0.0-8080-6) ejb:StatelessSessionBean@1c05227
17:03:24,518 INFO  [stdout] (http--0.0.0.0-8080-6) user:User 1

User 1 invoke
17:04:24,045 INFO  [stdout] (http--0.0.0.0-8080-1) ejb:StatelessSessionBean@406189
17:04:24,047 INFO  [stdout] (http--0.0.0.0-8080-1) user:User 1

User 2 invoke
17:04:24,179 INFO  [stdout] (http--0.0.0.0-8080-8) ejb:StatelessSessionBean@1c05227
17:04:24,179 INFO  [stdout] (http--0.0.0.0-8080-8) user:User 2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Perceba que mesmo sendo atendido pela mesma instância, o campo “loggedInUser” varia corretamente de acordo com o usuário que invocou o método.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Quando se começa a trabalhar com EJB uma das primeiras coisas a se aprender é sobre os diferentes tipos de beans, que na especificação 3.1 são: Stateful Session Beans (SFSB), Stateless Session Beans (SLSB), Singleton Sessions Beans e os Message-Drive Beans. Com isso vem uma das dúvidas mais comuns: “Qual a diferença entre beans Stateful e Stateless?”. Bem, esse post não é mais um para explicar essas diferenças, se você precisa disso segue um bom &lt;a target=&quot;_blank&quot; href=&quot;http://www.theserverside.com/tutorial/Which-EJB-to-use-Stateful-stateless-and-singleton-session-beans-compared&quot;&gt;link&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="EJB" scheme="http://marlonpatrick.info/categories/EJB/"/>
    
    
      <category term="Injeção de dependências" scheme="http://marlonpatrick.info/tags/Injecao-de-dependencias/"/>
    
      <category term="Stateless Session Bean" scheme="http://marlonpatrick.info/tags/Stateless-Session-Bean/"/>
    
  </entry>
  
  <entry>
    <title>PrimeFaces: Dynamic Menu and the error Cannot remove the same component twice</title>
    <link href="http://marlonpatrick.info/en/2013/01/24/primefaces-dynamic-menu-and-the-error-cannot-remove-the-same-component-twice/"/>
    <id>http://marlonpatrick.info/en/2013/01/24/primefaces-dynamic-menu-and-the-error-cannot-remove-the-same-component-twice/</id>
    <published>2013-01-25T01:39:00.000Z</published>
    <updated>2015-08-08T21:06:27.000Z</updated>
    
    <content type="html">&lt;p&gt;If you are using the MenuBar component PrimeFaces to generate dynamic menus you may have encountered the error:&lt;strong&gt;Can not remove the same component twice&lt;/strong&gt;. This error occurs for the same reason explained in the post &lt;a href=&quot;/en/2013/01/24/primefaces-dynamic-menu-and-the-harmless-menssage-unable-to-find-component-dot-dot-dot/&quot;&gt;PrimeFaces: Dynamic Menu and harmless message Unable to Find Component … &lt;/a&gt;.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;The difference is that the “Unable to find component …” message is just a warnning the server log to a very specific case can be a performance problem, since the message “Cannot remove the same component twice” is an error fact that prevents the rendering of JSF screen. In my case, the error occurs when a JSF Validator throws a ValidatorException a screen that has a dynamic menu (PrimeFaces MenuBar).&lt;/p&gt;
&lt;p&gt;Another important thing is that the error occurs in the 3.4.1 version of PrimeFaces (did not get to check other versions) in conjunction with the implementation Mojarra JSF 2.1.9 or higher. If the Mojarra version 2.1.9 is less than the error occurs instead is played on the server log the message “Unable to find component …”.&lt;/p&gt;
&lt;p&gt;The solution placed in the post mentioned above also serves to this case and there explain better why the issue. Just click &lt;a href=&quot;/en/2013/01/24/primefaces-dynamic-menu-and-the-harmless-menssage-unable-to-find-component-dot-dot-dot/&quot;&gt;here&lt;/a&gt; and gives a given. I have even opened a PrimeFaces issue in the bug tracking the following &lt;a target=&quot;_blank&quot; href=&quot;http://code.google.com/p/primefaces/issues/detail?id=4431&quot;&gt;link&lt;/a&gt;.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;If you are using the MenuBar component PrimeFaces to generate dynamic menus you may have encountered the error:&lt;strong&gt;Can not remove the same component twice&lt;/strong&gt;. This error occurs for the same reason explained in the post &lt;a href=&quot;/en/2013/01/24/primefaces-dynamic-menu-and-the-harmless-menssage-unable-to-find-component-dot-dot-dot/&quot;&gt;PrimeFaces: Dynamic Menu and harmless message Unable to Find Component … &lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/categories/JSF/PrimeFaces/"/>
    
    
      <category term="Dynamic Menu" scheme="http://marlonpatrick.info/tags/Dynamic-Menu/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="MenuBar" scheme="http://marlonpatrick.info/tags/MenuBar/"/>
    
      <category term="Mojarra" scheme="http://marlonpatrick.info/tags/Mojarra/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/tags/PrimeFaces/"/>
    
  </entry>
  
  <entry>
    <title>PrimeFaces: Menu Dinâmico e o erro Cannot remove the same component twice</title>
    <link href="http://marlonpatrick.info/pt-br/2013/01/24/primefaces-menu-dinamico-e-o-erro-cannot-remove-the-same-component-twice/"/>
    <id>http://marlonpatrick.info/pt-br/2013/01/24/primefaces-menu-dinamico-e-o-erro-cannot-remove-the-same-component-twice/</id>
    <published>2013-01-25T01:39:00.000Z</published>
    <updated>2015-08-03T03:26:09.000Z</updated>
    
    <content type="html">&lt;p&gt;Se você está usando o componente MenuBar do PrimeFaces para geração de menus dinâmicos pode ter se deparado com o erro:&lt;strong&gt;Cannot remove the same component twice&lt;/strong&gt;. Esse erro ocorre pelo mesmo motivo explicado no post &lt;a href=&quot;/blog/2013/01/24/primefaces-menu-dinamico-e-a-inofensiva-mensagem-unable-to-find-component-dot-dot-dot&quot;&gt;PrimeFaces:Menu Dinâmico E a Inofensiva Mensagem Unable to Find Component…&lt;/a&gt;.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;A diferença é que a mensagem “Unable to find component…” é apenas um warnning no log do servidor que num caso muito específico pode representar um problema de performance, já a mensagem “Cannot remove the same component twice” é um erro de fato que impede a renderização da tela JSF. No meu caso, o erro ocorre quando um Validator JSF lança uma ValidatorException numa tela que tem um menu dinâmico (PrimeFaces MenuBar).&lt;/p&gt;
&lt;p&gt;Outra coisa importante é que o erro ocorre na versão 3.4.1 do PrimeFaces(não cheguei a verificar outras versões) em conjunto com a implementação JSF Mojarra 2.1.9 ou superior. Caso a versão do Mojarra seja menor que a 2.1.9 ao invés de ocorrer erro é jogado no log do servidor a mensagem “Unable to find component…”.&lt;/p&gt;
&lt;p&gt;A solução colocada no post referido anteriormente também serve para esse caso e lá explico melhor o porque do problema. É só clicar &lt;a href=&quot;/blog/2013/01/24/primefaces-menu-dinamico-e-a-inofensiva-mensagem-unable-to-find-component-dot-dot-dot&quot;&gt;aqui&lt;/a&gt; e dá uma conferida. Já até abri uma issue no bug tracking do PrimeFaces no seguinte &lt;a target=&quot;_blank&quot; href=&quot;http://code.google.com/p/primefaces/issues/detail?id=4431&quot;&gt;link&lt;/a&gt;. Por enquanto é isso!&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Se você está usando o componente MenuBar do PrimeFaces para geração de menus dinâmicos pode ter se deparado com o erro:&lt;strong&gt;Cannot remove the same component twice&lt;/strong&gt;. Esse erro ocorre pelo mesmo motivo explicado no post &lt;a href=&quot;/blog/2013/01/24/primefaces-menu-dinamico-e-a-inofensiva-mensagem-unable-to-find-component-dot-dot-dot&quot;&gt;PrimeFaces:Menu Dinâmico E a Inofensiva Mensagem Unable to Find Component…&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/categories/JSF/PrimeFaces/"/>
    
    
      <category term="Dynamic Menu" scheme="http://marlonpatrick.info/tags/Dynamic-Menu/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="Menu Dinâmico" scheme="http://marlonpatrick.info/tags/Menu-Dinamico/"/>
    
      <category term="MenuBar" scheme="http://marlonpatrick.info/tags/MenuBar/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/tags/PrimeFaces/"/>
    
  </entry>
  
  <entry>
    <title>PrimeFaces: Dynamic Menu and harmless message Unable to find component ...</title>
    <link href="http://marlonpatrick.info/en/2013/01/24/primefaces-dynamic-menu-and-the-harmless-menssage-unable-to-find-component-dot-dot-dot/"/>
    <id>http://marlonpatrick.info/en/2013/01/24/primefaces-dynamic-menu-and-the-harmless-menssage-unable-to-find-component-dot-dot-dot/</id>
    <published>2013-01-24T15:00:00.000Z</published>
    <updated>2015-08-03T03:06:36.000Z</updated>
    
    <content type="html">&lt;p&gt;I am particularly hardcore fan of PrimeFaces and one of the components I like most is to generate dynamic menus. Virtually all applications have the concept of access profile which ends up making the MenuBar component extremely useful for this type of requirement. Basically, the system will only render the menus which point to screens that the user can access.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Well, I’m using that component precisely in the above scenario with the 3.4.1 version of PrimeFaces and the implementation of JSF reference (Mojarra) in the version 2.1.7. With this combination (PrimeFaces/Mojarra) n the versions described above (believe in others as well) realized in the log my application every time performing an ajax call for each menu item generated with the dynamic MenuBar, there was a message something like this:&lt;strong&gt;Unable to find component with clientId ‘menuitem200’, the need to remove it&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Up to a certain moment nothing affected me such a message, and is probably so for 99% of cases. Now, if you like me, it fell to the remaining 1%, this message can cause a serious performance problem in ajax calls. This performance problem will only happen if you have a very large page, with many components generated as was my case.&lt;/p&gt;
&lt;p&gt;Every time I made a ajax call that page the procedure performed by PrimeFaces that generated the message “Unable to find component …” came to take about 1 minute and 30 seconds to finish, which is totally impractical. It’s not that the code runs on the call was super heavy, these more than 1 minute refer only method execution that generated the messages as shown in the log below:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;02:40:00,876 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenu1&amp;apos;, no need to remove it.
02:40:01,298 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenu2&amp;apos;, no need to remove it.
02:40:01,656 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitem45&amp;apos;, no need to remove it.
02:40:02,014 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitem4&amp;apos;, no need to remove it.
02:40:02,361 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenu20&amp;apos;, no need to remove it.

...many others messages here...

02:40:44,240 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitemespacobefore&amp;apos;, no need to remove it.
02:40:44,917 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenuuseractions&amp;apos;, no need to remove it.
02:40:45,249 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitemchangepassword&amp;apos;, no need to remove it.
02:40:45,574 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitemlogout&amp;apos;, no need to remove it.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the above example, the total time was 46 seconds. Basically what happens is that the JSF Restore View phase runs the method that restores the state of the dynamic menus, where for each menu item is done a search on the entire tree of JSF components and due to page be great takes a considerable time. The worst is that as the message itself says, “the need to remove it,” is not necessary to remove this component of the JSF tree because in fact it has already been removed.&lt;/p&gt;
&lt;p&gt;In my case, what I realized is that when the dynamic menu item uses a link is not necessary that the removal PrimeFaces tries, as when the menu item uses an Action Expression, then yes, this procedure is necessary.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// It is not necessary to try to remove this MenuItem therefore it uses a link
MenuItem changePassword = new MenuItem();
changePassword.setId(&amp;quot;menuitemchangepassword&amp;quot;);
changePassword.setValue(&amp;quot;Change Password&amp;quot;);
changePassword.setUrl(&amp;quot;/user/changePassword.xhtml?faces-redirect=true&amp;quot;);
submenuUser.getChildren().add(changePassword);

//In fact it is necessary to remove the item menu to add the new object in the Restore View phase, because it uses a Action Expression
MethodExpression logoutAction = factory.createMethodExpression(context.getELContext(), &amp;quot;#{loginView.logout}&amp;quot;,
                null, new Class[] {});
MenuItem logout = new MenuItem();
logout.setId(&amp;quot;menuitemlogout&amp;quot;);
logout.setValue(&amp;quot;Logout&amp;quot;);
logout.setActionExpression(logoutAction);
submenuUser.getChildren().add(logout);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To solve this problem I created a PhaseListener that removes the menu items that use this link unnecessary restoration phase, leaving only those who use action expression.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class RestoreDynamicActionsObserver implements PhaseListener{

    public static final String DYNAMIC_ACTIONS_RENDERKIT = &amp;quot;HTML_BASIC&amp;quot;;

    @Override
    public PhaseId getPhaseId() {
        return PhaseId.RESTORE_VIEW;
    }

    @Override
    public void beforePhase(PhaseEvent event) {

        ResponseStateManager rsm = RenderKitUtils.getResponseStateManager(event.getFacesContext(), DYNAMIC_ACTIONS_RENDERKIT);

        HttpServletRequest httpRequest = WebUtils.getRequest();

        Object[] rawState = (Object[]) rsm.getState(event.getFacesContext(), httpRequest.getRequestURI().replaceFirst(httpRequest.getContextPath(), &amp;quot;&amp;quot;).split(&amp;quot;\\?&amp;quot;)[0]);
        if (rawState == null) {
            return;
        }

        Map&amp;lt;String, Object&amp;gt; state = (Map&amp;lt;String,Object&amp;gt;) rawState[1];

        if(state == null){
            return;
        }

        List&amp;lt;Object&amp;gt; savedActions = (List&amp;lt;Object&amp;gt;) state.get(RIConstants.DYNAMIC_ACTIONS);

        if(savedActions == null){
            return;
        }

        for (Iterator&amp;lt;Object&amp;gt; iterator = savedActions.iterator(); iterator.hasNext();) {
            Object object = iterator.next();
            ComponentStruct action = new ComponentStruct();
            action.restoreState(event.getFacesContext(), object); 

            //These are the only items that use Action Expression, and therefore should not be scrambled
            if(ComponentStruct.ADD.equals(action.action) &amp;amp;&amp;amp; 
                (action.clientId.equals(&amp;quot;menuitemlogout&amp;quot;) || action.clientId.equals(&amp;quot;submenuuseractions&amp;quot;))){
                continue;
            }

            //Other items use link, and so are removed from this collection
            if (action.clientId.startsWith(&amp;quot;menuitem&amp;quot;) 
                || action.clientId.startsWith(&amp;quot;submenu&amp;quot;)) {                
                iterator.remove();
            }            
        }

    }

    @Override
    public void afterPhase(PhaseEvent event) {
        //
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With PhaseListener up, I let only the menu items that use Action Expression in the collection of dynamic actions to restore. In my case, I have a menu with hundreds of items, of which only 2 or 3 using action expression and thus the time spent on the restoration of dynamic shares fell sharply with that adjustment, getting unnoticeable (as it should be). This is because the PhaseListener runs before restoring leaving only what is truly necessary. Oh, another thing, the message “Unable to find component …” should also disappear from your log.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;I am particularly hardcore fan of PrimeFaces and one of the components I like most is to generate dynamic menus. Virtually all applications have the concept of access profile which ends up making the MenuBar component extremely useful for this type of requirement. Basically, the system will only render the menus which point to screens that the user can access.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/categories/JSF/PrimeFaces/"/>
    
    
      <category term="Dynamic Menu" scheme="http://marlonpatrick.info/tags/Dynamic-Menu/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="MenuBar" scheme="http://marlonpatrick.info/tags/MenuBar/"/>
    
      <category term="Mojarra" scheme="http://marlonpatrick.info/tags/Mojarra/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/tags/PrimeFaces/"/>
    
  </entry>
  
  <entry>
    <title>PrimeFaces:Menu dinâmico e a inofensiva mensagem Unable to find component...</title>
    <link href="http://marlonpatrick.info/pt-br/2013/01/24/primefaces-menu-dinamico-e-a-inofensiva-mensagem-unable-to-find-component-dot-dot-dot/"/>
    <id>http://marlonpatrick.info/pt-br/2013/01/24/primefaces-menu-dinamico-e-a-inofensiva-mensagem-unable-to-find-component-dot-dot-dot/</id>
    <published>2013-01-24T15:00:00.000Z</published>
    <updated>2015-08-03T03:25:27.000Z</updated>
    
    <content type="html">&lt;p&gt;Eu sou particularmente fã incondicional do PrimeFaces e um dos componentes que mais gosto é o de gerar menus dinâmicos. Praticamente todas as aplicações tem o conceito de perfil de acesso o que acaba tornando o componente MenuBar extremamente útil para esse tipo de requisito. Basicamente, o sistema só irá renderizar os menus o qual apontam para telas que o usuário pode acessar.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Bem, estou usando esse componente exatamente no cenário descrito acima com a versão 3.4.1 do PrimeFaces e a implementação de referência do JSF(Mojarra) na sua versão 2.1.7. Com essa combinação (PrimeFaces/Mojarra) nas versões descritas acima (acredito que em outras também) percebi no log de minha aplicação que todas as vezes que executava uma chamada ajax, para cada item do menu gerado com o MenuBar dinâmico, havia uma mensagem mais ou menos assim:&lt;strong&gt;Unable to find component with clientId ‘menuitem200’, no need to remove it.&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Até um determinado momento em nada me afetava tal mensagem, e provavelmente é assim para 99% dos casos. Agora, se você assim como eu, caiu no 1% restante, essa mensagem pode causar um sério problema de performance nas chamadas ajax. Esse problema de performance só irá acontecer se você tiver uma página muito grande, com muitos componentes gerados como foi o meu caso.&lt;/p&gt;
&lt;p&gt;Toda vez que eu fazia uma chamada ajax nessa página o procedimento executado pelo PrimeFaces que gerava as mensagens “Unable to find component…” chegava a levar cerca de 1 minuto e 30 segundos para terminar, o que é totalmente inviável. Não é que o código executado na chamada era super pesado, esses mais de 1 minuto se referem apenas execução do método que gerava as mensagens como mostra o log abaixo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;02:40:00,876 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenu1&amp;apos;, no need to remove it.
02:40:01,298 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenu2&amp;apos;, no need to remove it.
02:40:01,656 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitem45&amp;apos;, no need to remove it.
02:40:02,014 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitem4&amp;apos;, no need to remove it.
02:40:02,361 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenu20&amp;apos;, no need to remove it.

...muitas outras mensagens aqui...

02:40:44,240 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitemespacobefore&amp;apos;, no need to remove it.
02:40:44,917 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;submenuuseractions&amp;apos;, no need to remove it.
02:40:45,249 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitemchangepassword&amp;apos;, no need to remove it.
02:40:45,574 INFO  [stdout] (http--0.0.0.0-8080-4) Unable to find component with clientId &amp;apos;menuitemlogout&amp;apos;, no need to remove it.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;No exemplo acima, o tempo total foi de 46 segundos. Basicamente o que acontece é que na fase JSF Restore View é executado o método que restaura o estado dos menus dinâmicos, onde, para cada item do menu é feito uma busca em toda a árvore de componentes do JSF e devido a página ser grande leva um tempo considerável. O pior é que, como a própria mensagem diz, “no need to remove it”, não é necessário remover tal componente da árvore JSF porque na verdade ele já foi removido.&lt;/p&gt;
&lt;p&gt;No meu caso, o que percebi é que quando o item do menu dinâmico usa um link não é necessário essa remoção que o PrimeFaces tenta fazer, já quando o item do menu usa uma Action Expression, aí sim, esse procedimento é necessário.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//Não é necessário tentar remover esse MenuItem, pois, ele usa um link
MenuItem changePassword = new MenuItem();
changePassword.setId(&amp;quot;menuitemchangepassword&amp;quot;);
changePassword.setValue(&amp;quot;Mudar Senha&amp;quot;);
changePassword.setUrl(&amp;quot;/user/changePassword.xhtml?faces-redirect=true&amp;quot;);
submenuUser.getChildren().add(changePassword);

//De fato é preciso remover o menu item para adicionar o novo objeto na fase de Restore View, pois, ele usa uma Action Expression
MethodExpression logoutAction = factory.createMethodExpression(context.getELContext(), &amp;quot;#{loginView.logout}&amp;quot;,
                null, new Class[] {});
MenuItem logout = new MenuItem();
logout.setId(&amp;quot;menuitemlogout&amp;quot;);
logout.setValue(&amp;quot;Sair&amp;quot;);
logout.setActionExpression(logoutAction);
submenuUser.getChildren().add(logout);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Pra resolver esse problema criei um PhaseListener que retira os itens de menu que usam link dessa fase de restauração desnecessária, deixando apenas os que usam action expression.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class RestoreDynamicActionsObserver implements PhaseListener{

    public static final String DYNAMIC_ACTIONS_RENDERKIT = &amp;quot;HTML_BASIC&amp;quot;;

    @Override
    public PhaseId getPhaseId() {
        return PhaseId.RESTORE_VIEW;
    }

    @Override
    public void beforePhase(PhaseEvent event) {

        ResponseStateManager rsm = RenderKitUtils.getResponseStateManager(event.getFacesContext(), DYNAMIC_ACTIONS_RENDERKIT);

        HttpServletRequest httpRequest = WebUtils.getRequest();

        Object[] rawState = (Object[]) rsm.getState(event.getFacesContext(), httpRequest.getRequestURI().replaceFirst(httpRequest.getContextPath(), &amp;quot;&amp;quot;).split(&amp;quot;\\?&amp;quot;)[0]);
        if (rawState == null) {
            return;
        }

        Map&amp;lt;String, Object&amp;gt; state = (Map&amp;lt;String,Object&amp;gt;) rawState[1];

        if(state == null){
            return;
        }

        List&amp;lt;Object&amp;gt; savedActions = (List&amp;lt;Object&amp;gt;) state.get(RIConstants.DYNAMIC_ACTIONS);

        if(savedActions == null){
            return;
        }

        for (Iterator&amp;lt;Object&amp;gt; iterator = savedActions.iterator(); iterator.hasNext();) {
            Object object = iterator.next();
            ComponentStruct action = new ComponentStruct();
            action.restoreState(event.getFacesContext(), object); 

            //Esses são os únicos itens que usam Action Expression, e portanto, não devem ser mexidos
            if(ComponentStruct.ADD.equals(action.action) &amp;amp;&amp;amp; 
                (action.clientId.equals(&amp;quot;menuitemlogout&amp;quot;) || action.clientId.equals(&amp;quot;submenuuseractions&amp;quot;))){
                continue;
            }

            //Os demais itens usam link, e por isso, são retirados dessa coleção
            if (action.clientId.startsWith(&amp;quot;menuitem&amp;quot;) 
                || action.clientId.startsWith(&amp;quot;submenu&amp;quot;)) {                
                iterator.remove();
            }            
        }

    }

    @Override
    public void afterPhase(PhaseEvent event) {
        //
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Com o PhaseListener acima, eu deixo apenas os itens de menu que usam Action Expression na coleção de ações dinâmicas a restaurar. No meu caso, tenho um menu com centenas de itens, dos quais, apenas 2 ou 3 usam action expression e com isso o tempo gasto na restauração das ações dinâmicas caiu bruscamente com  esse ajuste, ficando imperceptível(como deve ser). Isso acontece porque o PhaseListener executa antes da restauração deixando apenas o que realmente é necessário. Ah, outra coisa, as mensagens “Unable to find component…” também devem sumir do seu log. É isso.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Eu sou particularmente fã incondicional do PrimeFaces e um dos componentes que mais gosto é o de gerar menus dinâmicos. Praticamente todas as aplicações tem o conceito de perfil de acesso o que acaba tornando o componente MenuBar extremamente útil para esse tipo de requisito. Basicamente, o sistema só irá renderizar os menus o qual apontam para telas que o usuário pode acessar.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/categories/JSF/PrimeFaces/"/>
    
    
      <category term="Dynamic Menu" scheme="http://marlonpatrick.info/tags/Dynamic-Menu/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="Menu Dinâmico" scheme="http://marlonpatrick.info/tags/Menu-Dinamico/"/>
    
      <category term="MenuBar" scheme="http://marlonpatrick.info/tags/MenuBar/"/>
    
      <category term="PrimeFaces" scheme="http://marlonpatrick.info/tags/PrimeFaces/"/>
    
  </entry>
  
  <entry>
    <title>Seam Persistence: Configurando o FlushMode</title>
    <link href="http://marlonpatrick.info/pt-br/2012/11/02/configurando-o-flushmode-no-seam-persistence/"/>
    <id>http://marlonpatrick.info/pt-br/2012/11/02/configurando-o-flushmode-no-seam-persistence/</id>
    <published>2012-11-02T23:19:00.000Z</published>
    <updated>2015-08-02T17:49:49.000Z</updated>
    
    <content type="html">&lt;p&gt;Uma das grandes vantagens de usar o Seam Persistence é o Seam Managed Persistence Context (SMPC) que permite um melhor gerenciamento do EntityManager na sua aplicação. Com o SMPC é possível colocar o EntityManager num escopo CDI o que pode facilitar bastante a vida de nós desenvolvedores ajudando a minimizar bruscamente erros como o temido LazyInitializationException.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Porém, uma das coisas que tive dificuldade de encontrar na documentação do Seam Persistence foi como definir o FlushMode do meu EntityManager por isso resolvi fazer esse post. Dando uma fuçada no código do Seam, encontrei a classe FlushModeManager e sua implementação padrão FlushModeManagerImpl, que justamente são usadas para definir o flushMode do EntityManager gerenciado pelo SMPC.&lt;/p&gt;
&lt;p&gt;Por padrão, o Seam Persistence define o flushMode como AUTO. O problema do flushMode configurado como AUTO é que o desenvolvedor não tem domínio sobre o momento que o ORM irá sincronizar os objetos em memória com a base de dados, o que muitas vezes, pode gerar resultados inesperados. Se você concorda comigo e deseja mudar o flushMode usado pelo SMPC é só copiar o código abaixo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Produces
@ApplicationScoped
protected FlushModeManager createDefaultFlushModeManager() {
    FlushModeManagerImpl flushModeManager = new FlushModeManagerImpl();
    flushModeManager.setFlushModeType(FlushModeType.COMMIT);
    return flushModeManager;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Esse método irá produzir um bean CDI do tipo FlushModeManager que será usado pelo SMPC para definir o flushMode do EntityManager que ele irá gerenciar. O novo bean irá substituir o bean padrão criado pelo Seam Persistence, e com ele, você pode definir o flushMode de três maneiras: AUTO, COMMIT e MANUAL.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Uma das grandes vantagens de usar o Seam Persistence é o Seam Managed Persistence Context (SMPC) que permite um melhor gerenciamento do EntityManager na sua aplicação. Com o SMPC é possível colocar o EntityManager num escopo CDI o que pode facilitar bastante a vida de nós desenvolvedores ajudando a minimizar bruscamente erros como o temido LazyInitializationException.&lt;/p&gt;
    
    </summary>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/categories/JBoss-Seam/"/>
    
    
      <category term="Seam Managed Persistence Context" scheme="http://marlonpatrick.info/tags/Seam-Managed-Persistence-Context/"/>
    
      <category term="Seam Persistence" scheme="http://marlonpatrick.info/tags/Seam-Persistence/"/>
    
  </entry>
  
  <entry>
    <title>Seam Persistence: Configuring FlushMode</title>
    <link href="http://marlonpatrick.info/en/2012/11/02/configuring-flushmode-seam-persistence/"/>
    <id>http://marlonpatrick.info/en/2012/11/02/configuring-flushmode-seam-persistence/</id>
    <published>2012-11-02T23:19:00.000Z</published>
    <updated>2015-08-02T17:50:41.000Z</updated>
    
    <content type="html">&lt;p&gt;One of the great advantages of using Seam Persistence is the Seam Managed Persistence Context (SMPC) which allows better management of the EntityManager in your application. With the SMPC is possible to place the EntityManager in a CDI scope which can greatly ease the life of developers helping us to sharply minimize errors as the dreaded LazyInitializationException.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;But one of the things I had trouble finding in the Seam Persistence documentation was setting the FlushMode of my EntityManager so I decided to make this post. Giving poke around in Seam code, I found the FlushModeManager class and its standard FlushModeManagerImpl implementation, which are just used to set the flushMode in the EntityManager managed by SMPC.&lt;/p&gt;
&lt;p&gt;By default, Seam Persistence defines flushMode to AUTO. With flushMode the problem set to AUTO is that the developer has no control over the time the ORM will synchronize the in-memory objects with the database, which can often produce unexpected results. If you agree with me and want to change the flushMode used by SMPC Simply copy the code below:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Produces
@ApplicationScoped
protected FlushModeManager createDefaultFlushModeManager() {
    FlushModeManagerImpl flushModeManager = new FlushModeManagerImpl();
    flushModeManager.setFlushModeType(FlushModeType.COMMIT);
    return flushModeManager;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This method will produce a CDI bean of type FlushModeManager to be used by SMPC to set the flushMode in the EntityManager. The new bean will override the default bean created by Seam Persistence, and with it, you can set the flushMode in three ways: AUTO, MANUAL and COMMIT.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;One of the great advantages of using Seam Persistence is the Seam Managed Persistence Context (SMPC) which allows better management of the EntityManager in your application. With the SMPC is possible to place the EntityManager in a CDI scope which can greatly ease the life of developers helping us to sharply minimize errors as the dreaded LazyInitializationException.&lt;/p&gt;
    
    </summary>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/categories/JBoss-Seam/"/>
    
    
      <category term="Seam Managed Persistence Context" scheme="http://marlonpatrick.info/tags/Seam-Managed-Persistence-Context/"/>
    
      <category term="Seam Persistence" scheme="http://marlonpatrick.info/tags/Seam-Persistence/"/>
    
  </entry>
  
  <entry>
    <title>Seam Faces: TransactionPhaseListener and the error JBAS010152</title>
    <link href="http://marlonpatrick.info/en/2012/10/31/seam-faces-transactionphaselistener-and-the-error-jbas010152/"/>
    <id>http://marlonpatrick.info/en/2012/10/31/seam-faces-transactionphaselistener-and-the-error-jbas010152/</id>
    <published>2012-10-31T19:40:00.000Z</published>
    <updated>2015-08-03T03:28:24.000Z</updated>
    
    <content type="html">&lt;p&gt;If you are using Seam Faces you may have already come across the following message in the log of your application:&lt;br&gt;&lt;strong&gt;JBAS010152: APPLICATION ERROR: transaction still active in request with status 0&lt;/strong&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;This message is caused by the malfunction of the transaction control of your system, more specifically, by the malfunction of TransactionPhaseListener class, contained in the Seam Faces jar. Basically, TransactionPhaseListener implements a common JSF PhaseListener at the beginning of every request opens a new transaction and the end of the request performs the transaction commit or rollback.&lt;/p&gt;
&lt;p&gt;The problem is that the TransactionPhaseListener is enabled by default since your project has the Seam Faces, Seam Seam Transaction Persistence and thus the mere fact of placing these libs in your project already adds the behavior described above in the system, and most cases, has conflicting with the transaction control chosen to be used in the application. In my case, the TransactionPhaseListener behavior did not meet and worse, interfered. The solution I found was to disable this behavior through the following setting in beans.xml file:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://java.sun.com/xml/ns/javaee&amp;quot; xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:s=&amp;quot;urn:java:ee&amp;quot; xmlns:t=&amp;quot;urn:java:org.jboss.seam.transaction&amp;quot;
       xmlns:ft=&amp;quot;urn:java:org.jboss.seam.faces.transaction&amp;quot;
       xmlns:sc=&amp;quot;urn:java:org.jboss.solder.core&amp;quot;
       xsi:schemaLocation=&amp;quot;http://java.sun.com/xml/ns/javaee http://docs.jboss.org/cdi/beans_1_0.xsd&amp;quot;&amp;gt;

    &amp;lt;!-- Others Configurations --&amp;gt;

    &amp;lt;sc:Veto&amp;gt;
        &amp;lt;!-- Defines @Veto as a Qualifier --&amp;gt;
    &amp;lt;s:Qualifier/&amp;gt;
    &amp;lt;/sc:Veto&amp;gt;

    &amp;lt;ft:TransactionPhaseListener&amp;gt;
         &amp;lt;!--  Preventing class TransactionPhaseListener from being installed as CDI bean.
             This class is responsible by message: JBAS010152: APPLICATION ERROR: transaction still active in request with status 0. 
            --&amp;gt; 
    &amp;lt;s:replaces/&amp;gt;
    &amp;lt;sc:Veto/&amp;gt;
    &amp;lt;/ft:TransactionPhaseListener&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this setting in beans.xml the TransactionPhaseListener class will be ignored by the CDI and so is disabled, thus eliminating the problem in the transaction control and that annoying message (JBAS010152). In fact, when I got rid of this problem appeared others in my project because he was hiding some defects in my transaction control, then I recommend trying to validate its strategy after disable TransactionPhaseListener and make sure it is in working order.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;If you are using Seam Faces you may have already come across the following message in the log of your application:&lt;br&gt;&lt;strong&gt;JBAS010152: APPLICATION ERROR: transaction still active in request with status 0&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/categories/JBoss-Seam/"/>
    
    
      <category term="CDI" scheme="http://marlonpatrick.info/tags/CDI/"/>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/tags/JBoss-Seam/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="Seam Faces" scheme="http://marlonpatrick.info/tags/Seam-Faces/"/>
    
      <category term="Seam Solder" scheme="http://marlonpatrick.info/tags/Seam-Solder/"/>
    
  </entry>
  
  <entry>
    <title>Seam Faces: TransactionPhaseListener e o erro JBAS010152</title>
    <link href="http://marlonpatrick.info/pt-br/2012/10/31/seam-faces-transactionphaselistener-e-o-erro-jbas010152/"/>
    <id>http://marlonpatrick.info/pt-br/2012/10/31/seam-faces-transactionphaselistener-e-o-erro-jbas010152/</id>
    <published>2012-10-31T19:40:00.000Z</published>
    <updated>2015-08-03T03:27:22.000Z</updated>
    
    <content type="html">&lt;p&gt;Se você está usando Seam Faces pode já ter se deparado com a seguinte mensagem no log de sua aplicação:&lt;br&gt;&lt;strong&gt;JBAS010152: APPLICATION ERROR: transaction still active in request with status 0&lt;/strong&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Essa mensagem é provocada pelo mal funcionamento do controle de transação do seu sistema, mais especificamente, pelo mal funcionamento da classe TransactionPhaseListener, contida no jar do Seam Faces. Basicamente, TransactionPhaseListener implementa um PhaseListener comum do JSF que no início de toda requisição abre uma nova transação e no final da requisição realiza o commit ou rollback da transação.&lt;/p&gt;
&lt;p&gt;O problema é que o TransactionPhaseListener é habilitado por padrão desde que o seu projeto tenha o Seam Faces, Seam Persistence e Seam Transaction, assim, o simples fato de colocar essas libs no seu projeto já adiciona o comportamento acima descrito no sistema, e na maioria dos casos, acaba entrando em conflito com o controle de transação escolhido para ser usado na aplicação. No meu caso, o comportamento do TransactionPhaseListener não atendia e pior, atrapalhava. A solução que encontrei foi desabilitar esse comportamento através da seguinte configuração no arquivo beans.xml:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://java.sun.com/xml/ns/javaee&amp;quot; xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:s=&amp;quot;urn:java:ee&amp;quot; xmlns:t=&amp;quot;urn:java:org.jboss.seam.transaction&amp;quot;
       xmlns:ft=&amp;quot;urn:java:org.jboss.seam.faces.transaction&amp;quot;
       xmlns:sc=&amp;quot;urn:java:org.jboss.solder.core&amp;quot;
       xsi:schemaLocation=&amp;quot;http://java.sun.com/xml/ns/javaee http://docs.jboss.org/cdi/beans_1_0.xsd&amp;quot;&amp;gt;

    &amp;lt;!-- Others Configurations --&amp;gt;

    &amp;lt;sc:Veto&amp;gt;
        &amp;lt;!-- Defines @Veto as a Qualifier --&amp;gt;
    &amp;lt;s:Qualifier/&amp;gt;
    &amp;lt;/sc:Veto&amp;gt;

    &amp;lt;ft:TransactionPhaseListener&amp;gt;
         &amp;lt;!--  Preventing class TransactionPhaseListener from being installed as CDI bean.
             This class is responsible by message: JBAS010152: APPLICATION ERROR: transaction still active in request with status 0. 
            --&amp;gt; 
    &amp;lt;s:replaces/&amp;gt;
    &amp;lt;sc:Veto/&amp;gt;
    &amp;lt;/ft:TransactionPhaseListener&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Com essa configuração no beans.xml a classe TransactionPhaseListener será ignorada pelo CDI e portanto ficará desabilitada, eliminando assim o problema no controle de transação e aquela mensagem chata (JBAS010152). Na verdade, quando consegui me livrar desse problema apareceram outros no meu projeto, pois, ele estava ocultando alguns defeitos no meu controle de transação, então, recomendo tentar validar sua estratégia após desabilitar o TransactionPhaseListener e se certificar que está em perfeito funcionamento.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Se você está usando Seam Faces pode já ter se deparado com a seguinte mensagem no log de sua aplicação:&lt;br&gt;&lt;strong&gt;JBAS010152: APPLICATION ERROR: transaction still active in request with status 0&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/categories/JSF/JBoss-Seam/"/>
    
    
      <category term="CDI" scheme="http://marlonpatrick.info/tags/CDI/"/>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/tags/JBoss-Seam/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="Seam Faces" scheme="http://marlonpatrick.info/tags/Seam-Faces/"/>
    
      <category term="Seam Solder" scheme="http://marlonpatrick.info/tags/Seam-Solder/"/>
    
  </entry>
  
  <entry>
    <title>JSF Form Validation:Abordagem prática com apoio da API Bean Validation + Seam Faces</title>
    <link href="http://marlonpatrick.info/pt-br/2012/07/12/jsf-form-validation-abordagem-pratica-com-apoio-da-api-bean-validation/"/>
    <id>http://marlonpatrick.info/pt-br/2012/07/12/jsf-form-validation-abordagem-pratica-com-apoio-da-api-bean-validation/</id>
    <published>2012-07-12T22:08:00.000Z</published>
    <updated>2015-08-03T02:15:52.000Z</updated>
    
    <content type="html">&lt;p&gt;Bem, se você já trabalha com JSF a algum tempo sabe que criar telas com fluxos um pouco mais complexos usando as validações built-in ou até mesmo Bean Validation sabe que isso pode se tornar um tanto complicado. Basicamente o problema é que muitas vezes as validações são acionadas em momentos inoportunos, momentos em que não é necessário a tal validação, mas, isso acontece devido ao tão mencionado ciclo de vida JSF.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Um exemplo bem simples pra quem usa Primefaces é ao se trabalhar com abas, onde, cada vez que você muda de aba as validações são chamadas pelo JSF, o que em muitos casos é desnecessário. Para saber mais: &lt;a href=&quot;http://code.google.com/p/primefaces/issues/detail?id=3423&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://code.google.com/p/primefaces/issues/detail?id=3423&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sim, eu sei que dá pra contornar a maioria desses problemas com o processamento parcial (atributo execute nas tags padrões e process nas tags Primefaces), mas, a verdade é que o código começa a ficar complexo e em alguns casos não tem jeito mesmo e muita gente acaba abdicando dessas validações e colocam as validações no próprio back bean.&lt;/p&gt;
&lt;p&gt;Pois bem, esses dias estava fazendo uma dessas telas e acabei me deparando com esses problemas. Deixar o código das páginas complexo não é uma boa opção para esse trabalho e ficar fazendo as validações diretamente nos back beans também não me pareceu a solução mais elegante(apesar de funcionar bem). Nos tempos de Struts existia o conceito de validação de form o que não é natural no JSF, pois, os validadores são determinados componente a componente. Mas aí, encontrei essa funcionalidade no Seam Faces, com a tag &lt;s:validateform&gt;. Com essa tag do Seam Faces podemos definir um JSF Validator para o form e não apenas para um campo específico e esse validador é acionado assim que o form é submetido.&lt;/s:validateform&gt;&lt;/p&gt;
&lt;p&gt;Obs: Qualquer dificuldade de adicionar o Seam Faces no seu projeto leia este outro post &lt;a href=&quot;/pt-br/2012/06/14/adicionando-seam-faces-no-seu-projeto-maven/&quot;&gt;Adicionando Seam Faces No Seu Projeto Maven&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Com isso, já temos uma maneira de validar o form apenas no momento que o mesmo for submetido, mas, ainda teria de fazer as validações manualmente para cada campo, foi aí que me veio a idéia de usar a api Bean Validation para fazer esse trabalho para mim. A idéia é simples, eu coloco anotações Bean Validation no meu modelo, desabilito as validações do ciclo de vida JSF com a tag &lt;f:validatebean&gt; (JSF 2 e Bean Validation são integradas e as validações são ativadas por padrão) e valido o modelo no meu form validator chamando as validações Bean Validation programaticamente. Dessa forma meu form é validado com a api Bean Validation no momento exato que me interessa, ou seja, no submit.&lt;/f:validatebean&gt;&lt;/p&gt;
&lt;p&gt;O código para isso segue abaixo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import java.util.ArrayList;
import java.util.LinkedHashSet;
import java.util.Set;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.validator.BeanValidator;
import javax.faces.validator.FacesValidator;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;

import org.primefaces.component.tabview.Tab;

@FacesValidator(&amp;quot;formBeanValidator&amp;quot;)
public class FormBeanValidatorTeste implements Validator {


    protected Set&amp;lt;FacesMessage&amp;gt; allMessages;

    @Override
    public void validate(FacesContext context, UIComponent component, Object object) throws ValidatorException {

        ArrayList&amp;lt;FacesMessage&amp;gt; messages = new ArrayList&amp;lt;FacesMessage&amp;gt;(validateInputs(context, component,
                new BeanValidator()));

        if (!messages.isEmpty()) {
            if (isThrowsValidatorException()) {
                throw new ValidatorException(messages);
            }

            //As mensagens de erro ficam disponíveis para uma possível subclasse fazer uso
            this.allMessages = new LinkedHashSet&amp;lt;FacesMessage&amp;gt;(messages);
        }
    }

    /**
     * Varre todos os campos do form e caso seja um 
     * UIInput chama o BeanValidator padrão do JSF. 
     *
     *@author marlonpatrick10
     */
    private Set&amp;lt;FacesMessage&amp;gt; validateInputs(FacesContext context, UIComponent rootComponent,
            BeanValidator beanValidator) {

        Set&amp;lt;FacesMessage&amp;gt; messages = new LinkedHashSet&amp;lt;FacesMessage&amp;gt;();

        for (UIComponent children : rootComponent.getChildren()) {
            if (children == rootComponent) {
                continue;
            }

            if (!children.isRendered()) {
                continue;
            }

            if (Tab.class.isAssignableFrom(children.getClass())) {//Primefaces
                Tab tab = (Tab)children;
                if (tab.isDisabled()) {
                    continue;
                }
            }

            if (UIInput.class.isAssignableFrom(children.getClass())) {
                if (isValidatable(context, (UIInput)children)) {
                    validate(context, beanValidator, (UIInput)children, messages);
                }
            }

            messages.addAll(validateInputs(context, children, beanValidator));
        }

        return messages;
    }

    /**
     * Chama o BeanValidator padrão do JSF
     * para um determinado UIInput. 
     *
     *@author marlonpatrick10
     */
    protected void validate(FacesContext context, BeanValidator beanValidator, UIInput component,
            Set&amp;lt;FacesMessage&amp;gt; messages) {
        try {
            beanValidator.validate(context, component, component.getValue());
        } catch (ValidatorException exception) {
            if (exception.getFacesMessages() == null) {
                messages.add(exception.getFacesMessage());
            } else {
                messages.addAll(exception.getFacesMessages());
            }
        }
    }

    /**
     * O comportamento padrão é validar todos os UIInput,
     * mas, pode ser que não seja necessário validar 
     * um determinado componente numa tela.
     * 
     * Assim, esse validator pode ser extendido e o 
     * método usado para identificar se o componente 
     * deve ser ou não validado.
     *
     *@author marlonpatrick10
     */
    protected Boolean isValidatable(FacesContext context, UIInput input) {
        return true;
    }

    /**
     * O comportamento padrão é validar todos os UIInput,
     * e lançar uma ValidatorException caso haja erros.
     * Esse validator pode ser extendido e o 
     * método sobrescrito para não lançar a exceção,
     * assim o novo validator pode fazer validações extras.
     * 
     * As mensagens de erro do Bean Validation
     * ficam disponíveis no atributo this.allMessages.
     *
     *@author marlonpatrick10
     */
    protected Boolean isThrowsValidatorException() {
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;O FormBeanValidator pode servir para a maioria das telas, mas, ainda sim há casos que queremos especializar mais as validações. Abaixo segue um exemplo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import java.util.Set;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.validator.BeanValidator;
import javax.faces.validator.FacesValidator;
import javax.inject.Inject;

import GenericUtils;
import FormBeanValidator;

@FacesValidator(&amp;quot;userFormBeanValidator&amp;quot;)
public class UserFormBeanValidator extends FormBeanValidator {

    @Inject
    UserView userView;//back bean

    @Override
    protected Boolean isValidatable(FacesContext context, UIInput input) {
        //No momento do submit da tela de cadastro de usuário 
        //não é preciso validar os campos abaixo

        if (input.getClientId().endsWith(&amp;quot;fieldX&amp;quot;)) {
            return false;
        }

        if (input.getClientId().endsWith(&amp;quot;fieldY&amp;quot;)) {
            return false;
        }

        return true;
    }

    @Override
    protected void validate(FacesContext context, BeanValidator beanValidator, UIInput component,
            Set&amp;lt;FacesMessage&amp;gt; messages) {

        //email2 não pode ser anotado com @NotNull, pois, sua obrigatoriedade é condicional
        if (this.userView.isAdmin()) {
            if (component.getClientId().endsWith(&amp;quot;email2&amp;quot;)) {
                if (GenericUtils.isBlankOrNull((String)component.getValue())) {
                    this.allMessages.add(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                            &amp;quot;Usuário admin deve informar 2 emails.&amp;quot;,null));
                }
            }
        }

        //chama Bean Validation mesmo para email2, pois, 
        //User.email2 está anotado com @Email, então, 
        //ainda precisa ser validado
        super.validate(context, beanValidator, component, messages);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Na página(xhtml) deve ficar algo como segue abaixo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;
    xmlns:h=&amp;quot;http://java.sun.com/jsf/html&amp;quot;
    xmlns:f=&amp;quot;http://java.sun.com/jsf/core&amp;quot;
    xmlns:s=&amp;quot;http://jboss.org/seam/faces&amp;quot;&amp;gt;

    &amp;lt;h:form id=&amp;quot;formInsertUser&amp;quot; prependId=&amp;quot;false&amp;quot;&amp;gt;
        &amp;lt;f:validateBean disabled=&amp;quot;true&amp;quot;&amp;gt;
            &amp;lt;!-- Os campos anotados com Bean Validation devem ficar aqui --&amp;gt;
        &amp;lt;/f:validateBean&amp;gt;

        &amp;lt;h:commandLink value=&amp;quot;Salvar&amp;quot; action=&amp;quot;#{userView.insert}&amp;quot; /&amp;gt;

        &amp;lt;!-- O validator será chamado no click do commandLink --&amp;gt;
        &amp;lt;s:validateForm validatorId=&amp;quot;userFormBeanValidator&amp;quot; /&amp;gt;
    &amp;lt;/h:form&amp;gt;

&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Essa validação de form aliada ao Bean Validation vai me ajudar muito a construir páginas mais complexas com JSF sem ter tanta dor de cabeça com validações fora de hora, espero que ajude você também.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Bem, se você já trabalha com JSF a algum tempo sabe que criar telas com fluxos um pouco mais complexos usando as validações built-in ou até mesmo Bean Validation sabe que isso pode se tornar um tanto complicado. Basicamente o problema é que muitas vezes as validações são acionadas em momentos inoportunos, momentos em que não é necessário a tal validação, mas, isso acontece devido ao tão mencionado ciclo de vida JSF.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/categories/JSF/JBoss-Seam/"/>
    
    
      <category term="Bean Validation" scheme="http://marlonpatrick.info/tags/Bean-Validation/"/>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/tags/JBoss-Seam/"/>
    
      <category term="JSF" scheme="http://marlonpatrick.info/tags/JSF/"/>
    
      <category term="JSF Form Validation" scheme="http://marlonpatrick.info/tags/JSF-Form-Validation/"/>
    
      <category term="JSF Validation" scheme="http://marlonpatrick.info/tags/JSF-Validation/"/>
    
      <category term="JSR 303" scheme="http://marlonpatrick.info/tags/JSR-303/"/>
    
      <category term="Seam Faces" scheme="http://marlonpatrick.info/tags/Seam-Faces/"/>
    
  </entry>
  
  <entry>
    <title>JSF Form Validation: Practical approach with support from the Bean Validation API + Seam Faces</title>
    <link href="http://marlonpatrick.info/en/2012/07/12/jsf-form-validation-pratical-approach-with-support-from-bean-validation-api/"/>
    <id>http://marlonpatrick.info/en/2012/07/12/jsf-form-validation-pratical-approach-with-support-from-bean-validation-api/</id>
    <published>2012-07-12T22:08:00.000Z</published>
    <updated>2015-08-03T02:15:46.000Z</updated>
    
    <content type="html">&lt;p&gt;Well, if you already work with JSF some time knows that creating screens with a little more complex flows using the built-in validations or even Bean Validation know that this can become somewhat complicated. Basically the problem is that often the validations are triggered at inopportune moments, times when it is not necessary to such validation, but this is due to overstated JSF lifecycle.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;A simple example for those who use Primefaces is when working with tabs, where each time you change tab validations are called by JSF, which in many cases is unnecessary. To learn more: &lt;a href=&quot;http://code.google.com/p/primefaces/issues/detail?id=3423&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://code.google.com/p/primefaces/issues/detail?id=3423&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Yes, I know it gives to circumvent most of these problems with partial rendering (attribute execute in the standards tags and process in the Primefaces tags), but the truth is that the code starts to get complex and in some cases has not hopeless and many people end up giving up these validations and put validations in the own back bean.&lt;/p&gt;
&lt;p&gt;Well, those days doing one of these screens and ended up running into these problems. Leave the code of complex pages is not a good fit for the job and keep doing validations directly in back beans also did not seem the most elegant solution (although work well). In Struts times there was the concept of form validation which is not natural in JSF therefore validators are determined component to component. But then I found this functionality in Seam Faces, with the tag &lt;s:validateform&gt;. With this Seam Faces tag can define a JSF Validator for form and not just for a particular field and this validator is triggered as soon as the form is submitted.&lt;/s:validateform&gt;&lt;/p&gt;
&lt;p&gt;Note: Any difficulty adding Seam Faces in your project read this other post [Adding Seam Faces In Your Maven Project] (/en/2012/06/14/adding-seam-faces-in-your-maven-project/).&lt;/p&gt;
&lt;p&gt;Thus, we already have a way to validate the form only at the time that it is submitted, but would still have to do the validations manually for each field, that’s when I had the idea to use the api Bean Validation to do this work for me. The idea is simple, I put Bean Validation annotations in my model, I disable the validation of the JSF life cycle with the &lt;f:validatebean&gt; (JSF 2 and Bean Validation are integrated and validations are enabled by default) and the valid model in my form validator calling validations Bean Validation programmatically. That way my form is validated with the api Bean Validation at the exact moment that interests me, that is, the submit.&lt;/f:validatebean&gt;&lt;/p&gt;
&lt;p&gt;The code for this is as follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import java.util.ArrayList;
import java.util.LinkedHashSet;
import java.util.Set;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.validator.BeanValidator;
import javax.faces.validator.FacesValidator;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;

import org.primefaces.component.tabview.Tab;

@FacesValidator(&amp;quot;formBeanValidator&amp;quot;)
public class FormBeanValidatorTeste implements Validator {


    protected Set&amp;lt;FacesMessage&amp;gt; allMessages;

    @Override
    public void validate(FacesContext context, UIComponent component, Object object) throws ValidatorException {

        ArrayList&amp;lt;FacesMessage&amp;gt; messages = new ArrayList&amp;lt;FacesMessage&amp;gt;(validateInputs(context, component,
                new BeanValidator()));

        if (!messages.isEmpty()) {
            if (isThrowsValidatorException()) {
                throw new ValidatorException(messages);
            }

            //The error messages are available for a possible subclass to use
            this.allMessages = new LinkedHashSet&amp;lt;FacesMessage&amp;gt;(messages);
        }
    }

    /**
     * Scans all form fields and if you are a
     * UIInput calls the standard BeanValidator JSF. 
     *
     *@author marlonpatrick10
     */
    private Set&amp;lt;FacesMessage&amp;gt; validateInputs(FacesContext context, UIComponent rootComponent,
            BeanValidator beanValidator) {

        Set&amp;lt;FacesMessage&amp;gt; messages = new LinkedHashSet&amp;lt;FacesMessage&amp;gt;();

        for (UIComponent children : rootComponent.getChildren()) {
            if (children == rootComponent) {
                continue;
            }

            if (!children.isRendered()) {
                continue;
            }

            if (Tab.class.isAssignableFrom(children.getClass())) {//Primefaces
                Tab tab = (Tab)children;
                if (tab.isDisabled()) {
                    continue;
                }
            }

            if (UIInput.class.isAssignableFrom(children.getClass())) {
                if (isValidatable(context, (UIInput)children)) {
                    validate(context, beanValidator, (UIInput)children, messages);
                }
            }

            messages.addAll(validateInputs(context, children, beanValidator));
        }

        return messages;
    }

    /**
     * Call the standard JSF BeanValidator
     * For a given UIInput.
     *@author marlonpatrick10
     */
    protected void validate(FacesContext context, BeanValidator beanValidator, UIInput component,
            Set&amp;lt;FacesMessage&amp;gt; messages) {
        try {
            beanValidator.validate(context, component, component.getValue());
        } catch (ValidatorException exception) {
            if (exception.getFacesMessages() == null) {
                messages.add(exception.getFacesMessage());
            } else {
                messages.addAll(exception.getFacesMessages());
            }
        }
    }

    /**
     * The default behavior is to validate all UIInput,
     * But it may be not necessary to validate
     * A particular component on a screen.
     *
     * So this validator can be extended and the
     * Method used to identify whether the component
     * Must be validated or not.
     *
     *@author marlonpatrick10
     */
    protected Boolean isValidatable(FacesContext context, UIInput input) {
        return true;
    }

    /**
     * The default behavior is to validate all UIInput,
     * And throw a ValidatorException if there are errors.
     * This validator can be extended and the
     * Method overridden to not throw the exception,
     * So the new validator can make extra validations.
     *
     * Error messages from the Bean Validation
     * Are available in this.allMessages attribute.
     *
     *@author marlonpatrick10
     */
    protected Boolean isThrowsValidatorException() {
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The FormBeanValidator can cater for most screens, but even so there are cases that want to specialize more validations. Here is an example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import java.util.Set;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.validator.BeanValidator;
import javax.faces.validator.FacesValidator;
import javax.inject.Inject;

import GenericUtils;
import FormBeanValidator;

@FacesValidator(&amp;quot;userFormBeanValidator&amp;quot;)
public class UserFormBeanValidator extends FormBeanValidator {

    @Inject
    UserView userView;//back bean

    @Override
    protected Boolean isValidatable(FacesContext context, UIInput input) {
        // Upon submit the user registration screen
        // No need to validate the fields below        

        if (input.getClientId().endsWith(&amp;quot;fieldX&amp;quot;)) {
            return false;
        }

        if (input.getClientId().endsWith(&amp;quot;fieldY&amp;quot;)) {
            return false;
        }

        return true;
    }

    @Override
    protected void validate(FacesContext context, BeanValidator beanValidator, UIInput component,
            Set&amp;lt;FacesMessage&amp;gt; messages) {

        //email2 can not be annotated with @NotNull therefore your obligation is conditional

        if (this.userView.isAdmin()) {
            if (component.getClientId().endsWith(&amp;quot;email2&amp;quot;)) {
                if (GenericUtils.isBlankOrNull((String)component.getValue())) {
                    this.allMessages.add(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                            &amp;quot;Admin user should tell two emails.&amp;quot;,null));
                }
            }
        }

        //Call Bean Validation even email2 therefore
        //User.email2 Is annotated with @Email then
        //Still needs to be validated
        super.validate(context, beanValidator, component, messages);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;On page (xhtml) should be something like follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;
    xmlns:h=&amp;quot;http://java.sun.com/jsf/html&amp;quot;
    xmlns:f=&amp;quot;http://java.sun.com/jsf/core&amp;quot;
    xmlns:s=&amp;quot;http://jboss.org/seam/faces&amp;quot;&amp;gt;

    &amp;lt;h:form id=&amp;quot;formInsertUser&amp;quot; prependId=&amp;quot;false&amp;quot;&amp;gt;
        &amp;lt;f:validateBean disabled=&amp;quot;true&amp;quot;&amp;gt;
            &amp;lt;!-- Fields annotated with Bean Validation should be here --&amp;gt;
        &amp;lt;/f:validateBean&amp;gt;

        &amp;lt;h:commandLink value=&amp;quot;Save&amp;quot; action=&amp;quot;#{userView.insert}&amp;quot; /&amp;gt;

        &amp;lt;!-- The validator will be called at the click commandLink --&amp;gt;
        &amp;lt;s:validateForm validatorId=&amp;quot;userFormBeanValidator&amp;quot; /&amp;gt;
    &amp;lt;/h:form&amp;gt;

&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This form of validation together with the Bean Validation will help me a lot to build more complex pages with JSF without much headache with validations out of turn, I hope it helps you too.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Well, if you already work with JSF some time knows that creating screens with a little more complex flows using the built-in validations or even Bean Validation know that this can become somewhat complicated. Basically the problem is that often the validations are triggered at inopportune moments, times when it is not necessary to such validation, but this is due to overstated JSF lifecycle.&lt;/p&gt;
    
    </summary>
    
      <category term="JSF" scheme="http://marlonpatrick.info/categories/JSF/"/>
    
      <category term="JBoss Seam" scheme="http://marlonpatrick.info/categories/JSF/JBoss-Seam/"/>
    
      <category term="Bean Validation" scheme="http://marlonpatrick.info/categories/JSF/JBoss-Seam/Bean-Validation/"/>
    
    
      <category term="JSF Validation" scheme="http://marlonpatrick.info/tags/JSF-Validation/"/>
    
      <category term="JSR 303" scheme="http://marlonpatrick.info/tags/JSR-303/"/>
    
      <category term="Seam Faces" scheme="http://marlonpatrick.info/tags/Seam-Faces/"/>
    
  </entry>
  
</feed>
